{"ast":null,"code":"var _jsxFileName = \"D:\\\\Kltn\\\\test\\\\social-media\\\\client\\\\src\\\\components\\\\Story\\\\StoryPage.js\";\nimport React, { Component } from \"react\";\nimport \"./StoryPage.scss\";\nimport { connect } from \"react-redux\";\nimport Stories from \"react-insta-stories\";\nimport { getStory, viewStory, deleteStory } from \"../../actions/product_actions\";\nimport { replyStory } from \"../../../src/actions/message_action\";\nimport { withRouter } from \"react-router-dom\";\nimport { Sticker, Send, PlayerPlay, PlayerPause, ArrowLeft, ArrowRight } from \"tabler-icons-react\";\nimport { Eye, Trash } from \"tabler-icons-react\";\nimport { Picker } from \"emoji-mart\";\nimport Reaction from \"../Reaction/index\";\nimport Slide from \"@material-ui/core/Slide\";\nimport { Snackbar } from \"@material-ui/core\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nconst Transition = React.forwardRef(function Transition(props, ref) {\n  return /*#__PURE__*/React.createElement(Slide, Object.assign({\n    direction: \"up\",\n    ref: ref\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 10\n    }\n  }));\n});\n\nclass StoryPage extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      storyId: \"\",\n      currentDisplay: 0,\n      previousStoryId: \"\",\n      storyToShow: null,\n      nextStoryId: \"\",\n      currentIndex: 0,\n      startIndex: 0,\n      end: -1,\n      isStoryPlaying: true,\n      content: \"\",\n      mess: {\n        sentTo: \"\",\n        sentBy: \"\",\n        content: \"\",\n        type: \"replyStory\",\n        attachment: \"\"\n      },\n      sendSucess: false,\n      message: \"\"\n    };\n    this.loadingStory = {\n      url: \"https://nguahanoi.vn/wp-content/themes/gv-coporation/images/default.jpg\",\n      header: \"\"\n    };\n\n    this.endPosition = list => {\n      return list.findIndex(item => {\n        return item.stories.findIndex(item => {\n          return !item.viewedBy.some(item => item._id == this.props.user.userData._id);\n        }) == -1;\n      });\n    };\n\n    this.startIndex = stories => {\n      //tìm story\n      // let index = stories.findIndex(item => {return !item.viewedBy.includes(this.props.user.userData._id)});\n      let index = stories.findIndex(item => {\n        return !item.viewedBy.some(item => item._id == this.props.user.userData._id);\n      });\n\n      if (index === -1) {\n        return 0;\n      } else {\n        return index;\n      }\n    };\n\n    this.handleChange = event => {\n      this.setState({\n        mess: { ...this.state.mess,\n          content: event.target.value\n        }\n      });\n    };\n\n    this.nextStory = () => {\n      try {\n        if (this.state.nextStoryId != -1) {\n          const storyToShow = this.props.products.storyList.find(element => element._id === this.state.nextStoryId);\n          const index = this.props.products.storyList.indexOf(storyToShow);\n\n          if (index == this.state.end) {\n            this.props.history.push(`/newfeed`);\n          } else {\n            let startIndex = this.startIndex(storyToShow.stories);\n            let nextStoryId = -1;\n\n            if (index < this.props.products.storyList.length - 1) {\n              nextStoryId = this.props.products.storyList[index + 1]._id;\n            }\n\n            let previousStoryId = -1;\n\n            if (index > 0) {\n              previousStoryId = this.props.products.storyList[index - 1]._id;\n            }\n\n            console.log(storyToShow, nextStoryId, index, previousStoryId);\n            this.setState({\n              storyToShow: storyToShow,\n              nextStoryId: nextStoryId,\n              currentDisplay: index,\n              previousStoryId: previousStoryId,\n              startIndex: startIndex,\n              currentIndex: 0,\n              mess: { ...this.state.mess,\n                sentTo: storyToShow._id,\n                sentBy: this.props.user.userData._id,\n                attachment: storyToShow.stories[startIndex]._id\n              }\n            });\n          }\n        } else {\n          this.props.history.push(`/newfeed`);\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.previousStory = () => {\n      try {\n        if (this.state.previousStoryId != -1) {\n          const storyToShow = this.props.products.storyList.find(element => element._id === this.state.previousStoryId);\n          const index = this.props.products.storyList.indexOf(storyToShow); // if(index == this.state.end){\n          //     console.log(\"next story equals end index\")\n          //     // this.props.history.push(`/newfeed`);\n          // }else{\n\n          let startIndex = this.startIndex(storyToShow.stories);\n          let nextStoryId = -1;\n\n          if (index < this.props.products.storyList.length - 1) {\n            nextStoryId = this.props.products.storyList[index + 1]._id;\n          }\n\n          let previousStoryId = 0;\n\n          if (index > 0) {\n            previousStoryId = this.props.products.storyList[index - 1]._id;\n          }\n\n          console.log(storyToShow, nextStoryId, index, previousStoryId);\n          this.setState({\n            storyToShow: storyToShow,\n            nextStoryId: nextStoryId,\n            currentDisplay: index,\n            previousStoryId: previousStoryId,\n            startIndex: startIndex,\n            currentIndex: 0,\n            mess: { ...this.state.mess,\n              sentTo: storyToShow._id,\n              sentBy: this.props.user.userData._id,\n              attachment: storyToShow.stories[startIndex]._id\n            }\n          }); // }\n        } else {\n          console.log(\"next story equals -1\"); // this.props.history.push(`/newfeed`);\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.test = obj => {\n      console.log(\"testttttttttttttttttt\", obj.stories.map(item => {\n        return {\n          url: item.image,\n          header: {\n            profileImage: this.state.storyToShow.postedBy[0].avt,\n            heading: this.state.storyToShow.postedBy[0].userName,\n            subheading: \"12h\"\n          }\n        };\n      }));\n    };\n\n    this.close = () => {\n      console.log(\"close\");\n    };\n\n    this.customCollapsedComponent = ({\n      toggleMore,\n      action\n    }) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"story-overlay\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 7\n        }\n      }, this.state.isStoryPlaying ? /*#__PURE__*/React.createElement(PlayerPause, {\n        onClick: () => {\n          action(\"pause\");\n          this.pauseStory();\n        },\n        size: 40,\n        strokeWidth: 2,\n        color: \"white\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }\n      }) : /*#__PURE__*/React.createElement(PlayerPlay, {\n        onClick: () => {\n          action(\"play\");\n          this.pauseStory();\n        },\n        size: 40,\n        strokeWidth: 2,\n        color: \"white\",\n        id: \"playStoryButton\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }\n      }));\n    };\n\n    this.storyCreate = obj => {\n      return obj.stories.map(item => {\n        return {\n          url: item.image.url,\n          header: {\n            profileImage: this.state.storyToShow.postedBy[0].avt,\n            heading: this.state.storyToShow.postedBy[0].userName,\n            subheading: \"12h\"\n          },\n          seeMore: ({\n            close\n          }) => {\n            return /*#__PURE__*/React.createElement(\"div\", {\n              onClick: close,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 18\n              }\n            }, \"Hello, click to close this.\");\n          },\n          seeMoreCollapsed: this.customCollapsedComponent\n        };\n      });\n    };\n\n    this.viewStory = (items, index) => {\n      let nextId = \"\";\n\n      if (this.state.startIndex < this.state.storyToShow.stories.length) {\n        nextId = this.state.storyToShow.stories[this.state.startIndex]._id;\n      } else {\n        nextId = 0;\n      }\n\n      console.log(\"hereeeeee\", nextId);\n      this.setState({\n        mess: { ...this.state.mess,\n          attachment: nextId\n        }\n      }, () => {\n        console.log(\"hereeeeeeeeeeee\", this.state.mess);\n      });\n\n      if (index !== -1) {\n        viewStory(this.state.storyToShow.stories[index]._id);\n      }\n    };\n\n    this.increaseStartIndex = () => {\n      try {\n        if (this.state.startIndex < this.state.storyToShow.stories.length - 1) {\n          this.setState({\n            startIndex: this.state.startIndex + 1\n          });\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.deleteStory = () => {\n      this.props.dispatch(deleteStory(this.state.mess.attachment)).then(response => {\n        // console.log(\"delete storiesssss\",response)\n        if (response.payload.success) {\n          //Update story to show\n          //Update start index\n          //story will rerender\n          const storyToShow = { ...response.payload.storyList[0]\n          };\n\n          if (!response.payload.storyList.length || response.payload.storyList[0].stories.length == 0) {\n            this.props.history.push(\"/newfeed\");\n          } else {\n            if (this.state.startIndex == response.payload.storyList[0].stories.length) {\n              this.pauseStory();\n              this.setState({\n                storyToShow: response.payload.storyList[0],\n                startIndex: this.state.startIndex - 1\n              });\n            } else {\n              this.pauseStory();\n              this.setState({\n                storyToShow: response.payload.storyList[0]\n              });\n            }\n          }\n        }\n      });\n    };\n\n    this.submitForm = event => {\n      event.preventDefault();\n\n      if (this.state.mess.content.trim()) {\n        let dataToSubmit = this.state.mess;\n        console.log(dataToSubmit);\n        replyStory(dataToSubmit).then(response => {\n          if (response.messagelist) {\n            this.setState({\n              sendSucess: true,\n              message: \"success\",\n              mess: { ...this.state.mess,\n                content: \"\"\n              }\n            });\n          } else {\n            this.setState({\n              sendSucess: true,\n              message: \"error\"\n            });\n          }\n        });\n      } else {\n        console.log(\"Hờ ớ\");\n      }\n    };\n\n    this.sendReact = reaction => {\n      this.state.mess.content = reaction;\n      let dataToSubmit = this.state.mess;\n      dataToSubmit.type = \"replyWithReaction\";\n      replyStory(dataToSubmit).then(response => {\n        if (response.messagelist) {\n          this.setState({\n            sendSucess: true,\n            message: \"success\",\n            mess: { ...this.state.mess,\n              content: \"\"\n            }\n          });\n        } else {\n          this.setState({\n            sendSucess: true,\n            message: \"error\"\n          });\n        }\n      });\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.location.state == undefined) {\n      this.props.history.push(`/newfeed`);\n    } else {\n      const id = this.props.location.state.id;\n      this.setState({\n        storiId: id\n      });\n      this.props.dispatch(getStory(this.props.user.userData._id)).then(() => {\n        const storyToShow = this.props.products.storyList.find(element => element._id === id);\n        const index = this.props.products.storyList.indexOf(storyToShow); // tìm vị trí stories cuối cùng chưa đc xem bởi người dùng, khi xem hết story này sẽ direct qua trang NewFeed\n\n        let end = this.endPosition(this.props.products.storyList);\n        console.log(\"END INDEX\", end); // Vị trí story bắt đầu của storyToShow\n\n        let startIndex = this.startIndex(storyToShow.stories);\n        console.log(\"START INDEX\", startIndex); // Id của Stories tiếp theo\n\n        let nextStoryId = -1;\n\n        if (index < this.props.products.storyList.length - 1) {\n          nextStoryId = this.props.products.storyList[index + 1]._id;\n        }\n\n        let previousStoryId = 0; // Id của story phía trước\n\n        if (index > 0) {\n          previousStoryId = this.props.products.storyList[index - 1]._id;\n        }\n\n        this.setState({\n          storyToShow: storyToShow,\n          currentDisplay: index,\n          nextStoryId: nextStoryId,\n          startIndex: startIndex,\n          previousStoryId: previousStoryId,\n          end: end,\n          mess: { ...this.state.mess,\n            sentTo: this.props.products.storyList[index]._id,\n            sentBy: this.props.user.userData._id,\n            attachment: this.props.products.storyList[index].stories[this.state.startIndex]._id\n          }\n        }); // console.log(this.state.currentDisplay, this.state.storyToShow, this.state.nextStoryId);\n      });\n    }\n  } // tìm vị trí stories cuối cùng chưa đc xem bởi người dùng, khi xem hết story này sẽ direct qua trang NewFeed\n\n\n  // playStory(){\n  //     const overlay = document.getElementById(\"playStoryButton\");\n  //     console.log(overlay)\n  // }\n  pauseStory() {\n    const reply = document.querySelector(\".reply-wrapper\"); // const overlay = document.querySelector(\".overlay\");\n\n    if (reply.classList.contains(\"displayed\")) {\n      reply.classList.remove(\"displayed\"); // overlay.classList.remove(\"overlay-displayed\")\n\n      this.setState({\n        isStoryPlaying: true\n      });\n    } else {\n      reply.classList.add(\"displayed\"); // overlay.classList.add(\"overlay-displayed\")\n\n      this.setState({\n        isStoryPlaying: false\n      });\n    }\n  }\n\n  render() {\n    return this.state.storyToShow ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"storyPage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 433,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"storyPage__header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"header__logo\",\n      onClick: () => {\n        this.props.history.push(\"/newfeed\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      class: \"Logo_stunn\",\n      src: require(\"../../asset/logo/logoIcon2x.png\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      class: \"Logo_text\",\n      src: require(\"../../asset/logo/whiteLogo2x.png\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"close_button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      class: \"fas fa-times\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"current_story\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"story_wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 11\n      }\n    }, this.state.isStoryPlaying ? /*#__PURE__*/React.createElement(ArrowLeft, {\n      onClick: () => {\n        if (this.state.startIndex != 0) {\n          this.setState({\n            startIndex: this.state.startIndex - 1\n          }, () => {\n            this.viewStory(this.state.storyToShow, this.state.startIndex);\n          });\n        } else {\n          this.previousStory();\n        }\n      },\n      size: 40,\n      strokeWidth: 2,\n      color: \"white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 15\n      }\n    }) : \"\", /*#__PURE__*/React.createElement(Stories, {\n      stories: this.storyCreate(this.state.storyToShow),\n      defaultInterval: 5000,\n      width: \"26rem\",\n      height: \"100%\",\n      isPaused: true,\n      currentIndex: this.state.startIndex,\n      onStoryStart: () => {\n        this.viewStory(this.state.storyToShow, this.state.startIndex);\n      },\n      onStoryEnd: () => {\n        this.increaseStartIndex();\n      },\n      onAllStoriesEnd: () => this.nextStory(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 13\n      }\n    }), this.state.isStoryPlaying ? /*#__PURE__*/React.createElement(ArrowRight, {\n      onClick: () => {\n        console.log(this.state.startIndex, this.state.storyToShow.stories.length);\n\n        if (this.state.startIndex != this.state.storyToShow.stories.length - 1) {\n          this.setState({\n            startIndex: this.state.startIndex + 1\n          }, () => {\n            this.viewStory(this.state.storyToShow, this.state.startIndex);\n          });\n        } else {\n          this.nextStory();\n        }\n      },\n      size: 40,\n      strokeWidth: 2,\n      color: \"white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 498,\n        columnNumber: 15\n      }\n    }) : \"\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: this.state.mess.sentBy == this.state.mess.sentTo ? \"reply-wrapper space\" : \"reply-wrapper end\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: this.state.mess.sentBy == this.state.mess.sentTo ? \"main display\" : \"hiden\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 540,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"user-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 547,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"users-view-story\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 548,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Eye, {\n      size: 30,\n      strokeWidth: 2,\n      color: \"black\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 549,\n        columnNumber: 17\n      }\n    }), this.state.storyToShow.stories[this.state.startIndex].viewedBy.length != 0 ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 19\n      }\n    }, this.state.storyToShow.stories[this.state.startIndex].viewedBy.length, \" \", \"ng\\u01B0\\u1EDDi \\u0111\\xE3 xem\", \" \") : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 560,\n        columnNumber: 19\n      }\n    }, \"Ch\\u01B0a c\\xF3 ng\\u01B0\\u1EDDi xem\")), /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 15\n      }\n    }, this.state.storyToShow.stories[this.state.startIndex].viewedBy.map((item, idx) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item\",\n        key: idx,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 568,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        onClick: () => {// this.LinkTo(\"user\",item._id)\n        },\n        className: \"user_infor_wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 569,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: item.avt,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 575,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 576,\n          columnNumber: 25\n        }\n      }, item.userName)));\n    }))), /*#__PURE__*/React.createElement(Trash, {\n      onClick: this.deleteStory,\n      size: 25,\n      strokeWidth: 2,\n      color: \"black\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 583,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: this.state.mess.sentBy == this.state.mess.sentTo ? \"hiden\" : \"display\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 590,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Reaction, {\n      sendReact: reaction => this.sendReact(reaction),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 597,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: event => this.submitForm(event),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 598,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat_box\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 599,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat_area\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 600,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      id: \"description_textarea\",\n      autoComplete: \"none\",\n      type: \"text\",\n      value: this.state.mess.content,\n      placeholder: \"Nh\\u1EADp tin nh\\u1EAFn....\",\n      onChange: event => {\n        this.handleChange(event);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 601,\n        columnNumber: 19\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"emoji_icon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Sticker, {\n      onClick: this.emojiClick,\n      size: 32,\n      strokeWidth: 1,\n      color: \"black\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 613,\n        columnNumber: 19\n      }\n    }), this.state.emojiToggle ? /*#__PURE__*/React.createElement(Picker, {\n      style: {\n        position: \"absolute\",\n        right: 0,\n        top: \"20%\"\n      },\n      onSelect: this.addEmoji,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 620,\n        columnNumber: 21\n      }\n    }) : null), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"sent_btn\",\n      className: \"send_icon\",\n      onClick: event => {\n        this.submitForm(event);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 626,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Send, {\n      size: 32,\n      strokeWidth: 1,\n      color: \"white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 633,\n        columnNumber: 19\n      }\n    })))))), /*#__PURE__*/React.createElement(Snackbar, {\n      anchorOrigin: {\n        vertical: \"bottom\",\n        horizontal: \"left\"\n      },\n      open: this.state.sendSucess,\n      onClose: () => this.setState({\n        sendSucess: false\n      }),\n      autoHideDuration: 1000,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 641,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(MuiAlert, {\n      elevation: 6,\n      variant: \"filled\",\n      severity: this.state.message,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 650,\n        columnNumber: 13\n      }\n    }, this.state.message == \"success\" ? \"Đã gửi tin nhắn\" : \"Xin thử lại\"))) : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 663,\n        columnNumber: 7\n      }\n    }, \"loading\");\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user,\n    products: state.products\n  };\n};\n\nexport default connect(mapStateToProps)(withRouter(StoryPage));","map":{"version":3,"sources":["D:/Kltn/test/social-media/client/src/components/Story/StoryPage.js"],"names":["React","Component","connect","Stories","getStory","viewStory","deleteStory","replyStory","withRouter","Sticker","Send","PlayerPlay","PlayerPause","ArrowLeft","ArrowRight","Eye","Trash","Picker","Reaction","Slide","Snackbar","MuiAlert","Transition","forwardRef","props","ref","StoryPage","state","storyId","currentDisplay","previousStoryId","storyToShow","nextStoryId","currentIndex","startIndex","end","isStoryPlaying","content","mess","sentTo","sentBy","type","attachment","sendSucess","message","loadingStory","url","header","endPosition","list","findIndex","item","stories","viewedBy","some","_id","user","userData","index","handleChange","event","setState","target","value","nextStory","products","storyList","find","element","indexOf","history","push","length","console","log","err","previousStory","test","obj","map","image","profileImage","postedBy","avt","heading","userName","subheading","close","customCollapsedComponent","toggleMore","action","pauseStory","storyCreate","seeMore","seeMoreCollapsed","items","nextId","increaseStartIndex","dispatch","then","response","payload","success","submitForm","preventDefault","trim","dataToSubmit","messagelist","sendReact","reaction","componentDidMount","location","undefined","id","storiId","reply","document","querySelector","classList","contains","remove","add","render","require","idx","emojiClick","emojiToggle","position","right","top","addEmoji","vertical","horizontal","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./StoryPage.scss\";\nimport { connect } from \"react-redux\";\nimport Stories from \"react-insta-stories\";\nimport {\n  getStory,\n  viewStory,\n  deleteStory,\n} from \"../../actions/product_actions\";\nimport { replyStory } from \"../../../src/actions/message_action\";\nimport { withRouter } from \"react-router-dom\";\nimport {\n  Sticker,\n  Send,\n  PlayerPlay,\n  PlayerPause,\n  ArrowLeft,\n  ArrowRight,\n} from \"tabler-icons-react\";\nimport { Eye, Trash } from \"tabler-icons-react\";\nimport { Picker } from \"emoji-mart\";\nimport Reaction from \"../Reaction/index\";\nimport Slide from \"@material-ui/core/Slide\";\nimport { Snackbar } from \"@material-ui/core\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nconst Transition = React.forwardRef(function Transition(props, ref) {\n  return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nclass StoryPage extends Component {\n  state = {\n    storyId: \"\",\n    currentDisplay: 0,\n    previousStoryId: \"\",\n    storyToShow: null,\n    nextStoryId: \"\",\n    currentIndex: 0,\n    startIndex: 0,\n    end: -1,\n    isStoryPlaying: true,\n    content: \"\",\n    mess: {\n      sentTo: \"\",\n      sentBy: \"\",\n      content: \"\",\n      type: \"replyStory\",\n      attachment: \"\",\n    },\n    sendSucess: false,\n    message: \"\",\n  };\n  loadingStory = {\n    url: \"https://nguahanoi.vn/wp-content/themes/gv-coporation/images/default.jpg\",\n    header: \"\",\n  };\n  componentDidMount() {\n    if (this.props.location.state == undefined) {\n      this.props.history.push(`/newfeed`);\n    } else {\n      const id = this.props.location.state.id;\n      this.setState({ storiId: id });\n      this.props.dispatch(getStory(this.props.user.userData._id)).then(() => {\n        const storyToShow = this.props.products.storyList.find(\n          (element) => element._id === id\n        );\n        const index = this.props.products.storyList.indexOf(storyToShow);\n        // tìm vị trí stories cuối cùng chưa đc xem bởi người dùng, khi xem hết story này sẽ direct qua trang NewFeed\n        let end = this.endPosition(this.props.products.storyList);\n        console.log(\"END INDEX\", end);\n        // Vị trí story bắt đầu của storyToShow\n        let startIndex = this.startIndex(storyToShow.stories);\n        console.log(\"START INDEX\", startIndex);\n        // Id của Stories tiếp theo\n        let nextStoryId = -1;\n        if (index < this.props.products.storyList.length - 1) {\n          nextStoryId = this.props.products.storyList[index + 1]._id;\n        }\n        let previousStoryId = 0;\n        // Id của story phía trước\n        if (index > 0) {\n          previousStoryId = this.props.products.storyList[index - 1]._id;\n        }\n        this.setState({\n          storyToShow: storyToShow,\n          currentDisplay: index,\n          nextStoryId: nextStoryId,\n          startIndex: startIndex,\n          previousStoryId: previousStoryId,\n          end: end,\n          mess: {\n            ...this.state.mess,\n            sentTo: this.props.products.storyList[index]._id,\n            sentBy: this.props.user.userData._id,\n            attachment:\n              this.props.products.storyList[index].stories[\n                this.state.startIndex\n              ]._id,\n          },\n        });\n        // console.log(this.state.currentDisplay, this.state.storyToShow, this.state.nextStoryId);\n      });\n    }\n  }\n  // tìm vị trí stories cuối cùng chưa đc xem bởi người dùng, khi xem hết story này sẽ direct qua trang NewFeed\n  endPosition = (list) => {\n    return list.findIndex((item) => {\n      return (\n        item.stories.findIndex((item) => {\n          return !item.viewedBy.some(\n            (item) => item._id == this.props.user.userData._id\n          );\n        }) == -1\n      );\n    });\n  };\n\n  startIndex = (stories) => {\n    //tìm story\n    // let index = stories.findIndex(item => {return !item.viewedBy.includes(this.props.user.userData._id)});\n\n    let index = stories.findIndex((item) => {\n      return !item.viewedBy.some(\n        (item) => item._id == this.props.user.userData._id\n      );\n    });\n    if (index === -1) {\n      return 0;\n    } else {\n      return index;\n    }\n  };\n\n  handleChange = (event) => {\n    this.setState({\n      mess: { ...this.state.mess, content: event.target.value },\n    });\n  };\n\n  nextStory = () => {\n    try {\n      if (this.state.nextStoryId != -1) {\n        const storyToShow = this.props.products.storyList.find(\n          (element) => element._id === this.state.nextStoryId\n        );\n        const index = this.props.products.storyList.indexOf(storyToShow);\n        if (index == this.state.end) {\n          this.props.history.push(`/newfeed`);\n        } else {\n          let startIndex = this.startIndex(storyToShow.stories);\n          let nextStoryId = -1;\n          if (index < this.props.products.storyList.length - 1) {\n            nextStoryId = this.props.products.storyList[index + 1]._id;\n          }\n          let previousStoryId = -1;\n          if (index > 0) {\n            previousStoryId = this.props.products.storyList[index - 1]._id;\n          }\n          console.log(storyToShow, nextStoryId, index, previousStoryId);\n          this.setState({\n            storyToShow: storyToShow,\n            nextStoryId: nextStoryId,\n            currentDisplay: index,\n            previousStoryId: previousStoryId,\n            startIndex: startIndex,\n            currentIndex: 0,\n            mess: {\n              ...this.state.mess,\n              sentTo: storyToShow._id,\n              sentBy: this.props.user.userData._id,\n              attachment: storyToShow.stories[startIndex]._id,\n            },\n          });\n        }\n      } else {\n        this.props.history.push(`/newfeed`);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  previousStory = () => {\n    try {\n      if (this.state.previousStoryId != -1) {\n        const storyToShow = this.props.products.storyList.find(\n          (element) => element._id === this.state.previousStoryId\n        );\n        const index = this.props.products.storyList.indexOf(storyToShow);\n        // if(index == this.state.end){\n        //     console.log(\"next story equals end index\")\n        //     // this.props.history.push(`/newfeed`);\n        // }else{\n        let startIndex = this.startIndex(storyToShow.stories);\n        let nextStoryId = -1;\n        if (index < this.props.products.storyList.length - 1) {\n          nextStoryId = this.props.products.storyList[index + 1]._id;\n        }\n        let previousStoryId = 0;\n        if (index > 0) {\n          previousStoryId = this.props.products.storyList[index - 1]._id;\n        }\n        console.log(storyToShow, nextStoryId, index, previousStoryId);\n        this.setState({\n          storyToShow: storyToShow,\n          nextStoryId: nextStoryId,\n          currentDisplay: index,\n          previousStoryId: previousStoryId,\n          startIndex: startIndex,\n          currentIndex: 0,\n          mess: {\n            ...this.state.mess,\n            sentTo: storyToShow._id,\n            sentBy: this.props.user.userData._id,\n            attachment: storyToShow.stories[startIndex]._id,\n          },\n        });\n        // }\n      } else {\n        console.log(\"next story equals -1\");\n        // this.props.history.push(`/newfeed`);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  test = (obj) => {\n    console.log(\n      \"testttttttttttttttttt\",\n      obj.stories.map((item) => {\n        return {\n          url: item.image,\n          header: {\n            profileImage: this.state.storyToShow.postedBy[0].avt,\n            heading: this.state.storyToShow.postedBy[0].userName,\n            subheading: \"12h\",\n          },\n        };\n      })\n    );\n  };\n  close = () => {\n    console.log(\"close\");\n  };\n\n  // playStory(){\n  //     const overlay = document.getElementById(\"playStoryButton\");\n  //     console.log(overlay)\n  // }\n\n  pauseStory() {\n    const reply = document.querySelector(\".reply-wrapper\");\n    // const overlay = document.querySelector(\".overlay\");\n    if (reply.classList.contains(\"displayed\")) {\n      reply.classList.remove(\"displayed\");\n      // overlay.classList.remove(\"overlay-displayed\")\n      this.setState({ isStoryPlaying: true });\n    } else {\n      reply.classList.add(\"displayed\");\n      // overlay.classList.add(\"overlay-displayed\")\n      this.setState({ isStoryPlaying: false });\n    }\n  }\n  customCollapsedComponent = ({ toggleMore, action }) => {\n    return (\n      <div className=\"story-overlay\">\n        {this.state.isStoryPlaying ? (\n          <PlayerPause\n            onClick={() => {\n              action(\"pause\");\n              this.pauseStory();\n            }}\n            size={40}\n            strokeWidth={2}\n            color=\"white\"\n          />\n        ) : (\n          <PlayerPlay\n            onClick={() => {\n              action(\"play\");\n              this.pauseStory();\n            }}\n            size={40}\n            strokeWidth={2}\n            color=\"white\"\n            id=\"playStoryButton\"\n          />\n        )}\n      </div>\n    );\n  };\n\n  storyCreate = (obj) => {\n    return obj.stories.map((item) => {\n      return {\n        url: item.image.url,\n        header: {\n          profileImage: this.state.storyToShow.postedBy[0].avt,\n          heading: this.state.storyToShow.postedBy[0].userName,\n          subheading: \"12h\",\n        },\n        seeMore: ({ close }) => {\n          return <div onClick={close}>Hello, click to close this.</div>;\n        },\n        seeMoreCollapsed: this.customCollapsedComponent,\n      };\n    });\n  };\n\n  viewStory = (items, index) => {\n    let nextId = \"\";\n    if (this.state.startIndex < this.state.storyToShow.stories.length) {\n      nextId = this.state.storyToShow.stories[this.state.startIndex]._id;\n    } else {\n      nextId = 0;\n    }\n    console.log(\"hereeeeee\", nextId);\n    this.setState(\n      {\n        mess: {\n          ...this.state.mess,\n          attachment: nextId,\n        },\n      },\n      () => {\n        console.log(\"hereeeeeeeeeeee\", this.state.mess);\n      }\n    );\n    if (index !== -1) {\n      viewStory(this.state.storyToShow.stories[index]._id);\n    }\n  };\n\n  increaseStartIndex = () => {\n    try {\n      if (this.state.startIndex < this.state.storyToShow.stories.length - 1) {\n        this.setState({\n          startIndex: this.state.startIndex + 1,\n        });\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  deleteStory = () => {\n    this.props\n      .dispatch(deleteStory(this.state.mess.attachment))\n      .then((response) => {\n        // console.log(\"delete storiesssss\",response)\n        if (response.payload.success) {\n          //Update story to show\n          //Update start index\n          //story will rerender\n          const storyToShow = { ...response.payload.storyList[0] };\n          if (\n            !response.payload.storyList.length ||\n            response.payload.storyList[0].stories.length == 0\n          ) {\n            this.props.history.push(\"/newfeed\");\n          } else {\n            if (\n              this.state.startIndex ==\n              response.payload.storyList[0].stories.length\n            ) {\n              this.pauseStory();\n              this.setState({\n                storyToShow: response.payload.storyList[0],\n                startIndex: this.state.startIndex - 1,\n              });\n            } else {\n              this.pauseStory();\n              this.setState({\n                storyToShow: response.payload.storyList[0],\n              });\n            }\n          }\n        }\n      });\n  };\n\n  submitForm = (event) => {\n    event.preventDefault();\n    if (this.state.mess.content.trim()) {\n      let dataToSubmit = this.state.mess;\n      console.log(dataToSubmit);\n      replyStory(dataToSubmit).then((response) => {\n        if (response.messagelist) {\n          this.setState({\n            sendSucess: true,\n            message: \"success\",\n            mess: {\n              ...this.state.mess,\n              content: \"\",\n            },\n          });\n        } else {\n          this.setState({\n            sendSucess: true,\n            message: \"error\",\n          });\n        }\n      });\n    } else {\n      console.log(\"Hờ ớ\");\n    }\n  };\n\n  sendReact = (reaction) => {\n    this.state.mess.content = reaction;\n\n    let dataToSubmit = this.state.mess;\n    dataToSubmit.type = \"replyWithReaction\";\n    replyStory(dataToSubmit).then((response) => {\n      if (response.messagelist) {\n        this.setState({\n          sendSucess: true,\n          message: \"success\",\n          mess: {\n            ...this.state.mess,\n            content: \"\",\n          },\n        });\n      } else {\n        this.setState({\n          sendSucess: true,\n          message: \"error\",\n        });\n      }\n    });\n  };\n\n  render() {\n    return this.state.storyToShow ? (\n      <div className=\"storyPage\">\n        <div className=\"storyPage__header\">\n          <div\n            className=\"header__logo\"\n            onClick={() => {\n              this.props.history.push(\"/newfeed\");\n            }}\n          >\n            <img\n              class=\"Logo_stunn\"\n              src={require(\"../../asset/logo/logoIcon2x.png\")}\n            />\n            <img\n              class=\"Logo_text\"\n              src={require(\"../../asset/logo/whiteLogo2x.png\")}\n            />\n          </div>\n          <div className=\"close_button\">\n            <i class=\"fas fa-times\"></i>\n          </div>\n        </div>\n        <div className=\"current_story\">\n          <div className=\"story_wrapper\">\n            {this.state.isStoryPlaying ? (\n              <ArrowLeft\n                onClick={() => {\n                  if (this.state.startIndex != 0) {\n                    this.setState(\n                      {\n                        startIndex: this.state.startIndex - 1,\n                      },\n                      () => {\n                        this.viewStory(\n                          this.state.storyToShow,\n                          this.state.startIndex\n                        );\n                      }\n                    );\n                  } else {\n                    this.previousStory();\n                  }\n                }}\n                size={40}\n                strokeWidth={2}\n                color=\"white\"\n              />\n            ) : (\n              \"\"\n            )}\n            <Stories\n              stories={this.storyCreate(this.state.storyToShow)}\n              defaultInterval={5000}\n              width=\"26rem\"\n              height=\"100%\"\n              isPaused={true}\n              currentIndex={this.state.startIndex}\n              onStoryStart={() => {\n                this.viewStory(this.state.storyToShow, this.state.startIndex);\n              }}\n              onStoryEnd={() => {\n                this.increaseStartIndex();\n              }}\n              onAllStoriesEnd={() => this.nextStory()}\n            />\n            {this.state.isStoryPlaying ? (\n              <ArrowRight\n                onClick={() => {\n                  console.log(\n                    this.state.startIndex,\n                    this.state.storyToShow.stories.length\n                  );\n                  if (\n                    this.state.startIndex !=\n                    this.state.storyToShow.stories.length - 1\n                  ) {\n                    this.setState(\n                      {\n                        startIndex: this.state.startIndex + 1,\n                      },\n                      () => {\n                        this.viewStory(\n                          this.state.storyToShow,\n                          this.state.startIndex\n                        );\n                      }\n                    );\n                  } else {\n                    this.nextStory();\n                  }\n                }}\n                size={40}\n                strokeWidth={2}\n                color=\"white\"\n              />\n            ) : (\n              \"\"\n            )}\n          </div>\n        </div>\n        {/* <div className=\"overlay\" onClick={this.playStory}></div> */}\n        <div\n          className={\n            this.state.mess.sentBy == this.state.mess.sentTo\n              ? \"reply-wrapper space\"\n              : \"reply-wrapper end\"\n          }\n        >\n          <div\n            className={\n              this.state.mess.sentBy == this.state.mess.sentTo\n                ? \"main display\"\n                : \"hiden\"\n            }\n          >\n            <div className=\"user-list\">\n              <div className=\"users-view-story\">\n                <Eye size={30} strokeWidth={2} color=\"black\" />\n                {this.state.storyToShow.stories[this.state.startIndex].viewedBy\n                  .length != 0 ? (\n                  <p>\n                    {\n                      this.state.storyToShow.stories[this.state.startIndex]\n                        .viewedBy.length\n                    }{\" \"}\n                    người đã xem{\" \"}\n                  </p>\n                ) : (\n                  <p>Chưa có người xem</p>\n                )}\n              </div>\n              <ul>\n                {this.state.storyToShow.stories[\n                  this.state.startIndex\n                ].viewedBy.map((item, idx) => {\n                  return (\n                    <div className=\"item\" key={idx}>\n                      <div\n                        onClick={() => {\n                          // this.LinkTo(\"user\",item._id)\n                        }}\n                        className=\"user_infor_wrapper\"\n                      >\n                        <img src={item.avt} />\n                        <p>{item.userName}</p>\n                      </div>\n                    </div>\n                  );\n                })}\n              </ul>\n            </div>\n            <Trash\n              onClick={this.deleteStory}\n              size={25}\n              strokeWidth={2}\n              color=\"black\"\n            />\n          </div>\n          <div\n            className={\n              this.state.mess.sentBy == this.state.mess.sentTo\n                ? \"hiden\"\n                : \"display\"\n            }\n          >\n            <Reaction sendReact={(reaction) => this.sendReact(reaction)} />\n            <form onSubmit={(event) => this.submitForm(event)}>\n              <div className=\"chat_box\">\n                <div className=\"chat_area\">\n                  <input\n                    id=\"description_textarea\"\n                    autoComplete=\"none\"\n                    type=\"text\"\n                    value={this.state.mess.content}\n                    placeholder=\"Nhập tin nhắn....\"\n                    onChange={(event) => {\n                      this.handleChange(event);\n                    }}\n                  ></input>\n                </div>\n                <div className=\"emoji_icon\">\n                  <Sticker\n                    onClick={this.emojiClick}\n                    size={32}\n                    strokeWidth={1}\n                    color=\"black\"\n                  ></Sticker>\n                  {this.state.emojiToggle ? (\n                    <Picker\n                      style={{ position: \"absolute\", right: 0, top: \"20%\" }}\n                      onSelect={this.addEmoji}\n                    />\n                  ) : null}\n                </div>\n                <div\n                  id=\"sent_btn\"\n                  className=\"send_icon\"\n                  onClick={(event) => {\n                    this.submitForm(event);\n                  }}\n                >\n                  <Send size={32} strokeWidth={1} color=\"white\"></Send>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n\n        {\n          <Snackbar\n            anchorOrigin={{\n              vertical: \"bottom\",\n              horizontal: \"left\",\n            }}\n            open={this.state.sendSucess}\n            onClose={() => this.setState({ sendSucess: false })}\n            autoHideDuration={1000}\n          >\n            <MuiAlert\n              elevation={6}\n              variant=\"filled\"\n              severity={this.state.message}\n            >\n              {this.state.message == \"success\"\n                ? \"Đã gửi tin nhắn\"\n                : \"Xin thử lại\"}\n            </MuiAlert>\n          </Snackbar>\n        }\n      </div>\n    ) : (\n      <div>loading</div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    user: state.user,\n    products: state.products,\n  };\n};\nexport default connect(mapStateToProps)(withRouter(StoryPage));\n"]},"metadata":{},"sourceType":"module"}
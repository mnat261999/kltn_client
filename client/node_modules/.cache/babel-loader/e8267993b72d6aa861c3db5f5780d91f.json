{"ast":null,"code":"var _jsxFileName = \"D:\\\\Kltn\\\\test\\\\social-media\\\\client\\\\src\\\\components\\\\Tag\\\\index.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport \"./Tag.scss\";\nimport Layout from \"../../hoc/layout\";\nimport { getTag, followTag, unfollowTag } from \"../../actions/tag_actions\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { Link, withRouter } from \"react-router-dom\";\n\nclass Tag extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      id: \"\",\n      skip: 0,\n      limit: 6,\n      isLoading: false\n    };\n\n    this.LoadmoreCards = () => {\n      let skip = this.state.skip + this.state.limit;\n      this.props.dispatch(getTag(this.state.id, this.state.skip, this.state.limit)).then(() => {\n        this.setState({\n          isLoading: false,\n          skip\n        });\n      });\n    };\n  }\n\n  componentDidMount() {\n    const id = this.props.match.params.id;\n    this.setState({\n      id: id\n    });\n    this.props.dispatch(getTag(id, this.state.skip, this.state.limit, []));\n  }\n\n  followTag(id, previousState) {\n    this.props.dispatch(followTag(id, previousState));\n  }\n\n  unfollowTag(id, previousState) {\n    this.props.dispatch(unfollowTag(id, previousState));\n  }\n\n  handleScroll() {\n    const windowHeight = \"innerHeight\" in window ? window.innerHeight : document.documentElement.offsetHeight;\n    const body = document.body;\n    const html = document.documentElement;\n    const docHeight = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);\n    const windowBottom = Math.ceil(windowHeight + window.pageYOffset);\n    console.log(windowBottom, docHeight, windowHeight);\n\n    if (windowBottom >= docHeight) {\n      this.setState({\n        isLoading: true\n      }, () => {\n        this.LoadmoreCards();\n      });\n      console.log(\"bottom reached\");\n    }\n  }\n\n  render() {\n    const tag = this.props.tags.tag;\n    return this.props.tags.tag ? /*#__PURE__*/React.createElement(Layout, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"TagPage\",\n      onScroll: event => this.handleScroll(event),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tag_info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tag_image\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 13\n      }\n    }, tag.posts.length ? /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img\",\n      src: tag.posts[0].images[0].url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }\n    }) : /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img\",\n      src: \"https://kazcm.com/wp-content/uploads/2018/02/Hashtag.jpg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tag_name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 15\n      }\n    }, \"#\", tag.tag.name), /*#__PURE__*/React.createElement(\"h6\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 15\n      }\n    }, tag.posts.length, \" B\\xE0i vi\\u1EBFt\")), tag.tag.followers.includes(this.props.user.userData._id) ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"button_wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => this.unfollowTag(tag.tag._id, this.props.tags.tag),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, \"Unfollow\")) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"button_wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => this.followTag(tag.tag._id, this.props.tags.tag),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    }, \"Follow\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"posts\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }, tag.posts.map(item => {\n      return item.hidden ? null : /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-xl-4 col-md-4  pb-3 pt-3 \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"image-wrapper\",\n        onClick: () => {\n          this.props.history.push(`/postDetail/${item._id}`);\n        },\n        style: {\n          backgroundImage: `url(${item.images[0].url})`\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }\n      }));\n    }))), this.state.isLoading ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"main_loader\",\n      style: {\n        position: \"absolute\",\n        top: \"50%\",\n        left: \"50%\",\n        transform: \"translateX(-50 %) translateY(- 50 %)\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      style: {\n        color: \"#5477D5\"\n      },\n      thickness: 7,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 15\n      }\n    })) : \"\")) : \"\";\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    user: state.user,\n    tags: state.tags\n  };\n}\n\nexport default connect(mapStateToProps)(withRouter(Tag));","map":{"version":3,"sources":["D:/Kltn/test/social-media/client/src/components/Tag/index.js"],"names":["React","Component","connect","Layout","getTag","followTag","unfollowTag","CircularProgress","Link","withRouter","Tag","state","id","skip","limit","isLoading","LoadmoreCards","props","dispatch","then","setState","componentDidMount","match","params","previousState","handleScroll","windowHeight","window","innerHeight","document","documentElement","offsetHeight","body","html","docHeight","Math","max","scrollHeight","clientHeight","windowBottom","ceil","pageYOffset","console","log","render","tag","tags","event","posts","length","images","url","name","followers","includes","user","userData","_id","map","item","hidden","history","push","backgroundImage","position","top","left","transform","color","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport \"./Tag.scss\";\nimport Layout from \"../../hoc/layout\";\nimport { getTag, followTag, unfollowTag } from \"../../actions/tag_actions\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { Link, withRouter } from \"react-router-dom\";\n\nclass Tag extends Component {\n  state = {\n    id: \"\",\n    skip: 0,\n    limit: 6,\n    isLoading: false,\n  };\n\n  componentDidMount() {\n    const id = this.props.match.params.id;\n    this.setState({\n      id: id,\n    });\n    this.props.dispatch(getTag(id, this.state.skip, this.state.limit, []));\n  }\n\n  followTag(id, previousState) {\n    this.props.dispatch(followTag(id, previousState));\n  }\n\n  unfollowTag(id, previousState) {\n    this.props.dispatch(unfollowTag(id, previousState));\n  }\n\n  LoadmoreCards = () => {\n    let skip = this.state.skip + this.state.limit;\n    this.props\n      .dispatch(getTag(this.state.id, this.state.skip, this.state.limit))\n      .then(() => {\n        this.setState({\n          isLoading: false,\n          skip,\n        });\n      });\n  };\n\n  handleScroll() {\n    const windowHeight =\n      \"innerHeight\" in window\n        ? window.innerHeight\n        : document.documentElement.offsetHeight;\n    const body = document.body;\n    const html = document.documentElement;\n    const docHeight = Math.max(\n      body.scrollHeight,\n      body.offsetHeight,\n      html.clientHeight,\n      html.scrollHeight,\n      html.offsetHeight\n    );\n    const windowBottom = Math.ceil(windowHeight + window.pageYOffset);\n    console.log(windowBottom, docHeight, windowHeight);\n    if (windowBottom >= docHeight) {\n      this.setState({ isLoading: true }, () => {\n        this.LoadmoreCards();\n      });\n      console.log(\"bottom reached\");\n    }\n  }\n\n  render() {\n    const tag = this.props.tags.tag;\n    return this.props.tags.tag ? (\n      <Layout>\n        <div className=\"TagPage\" onScroll={(event) => this.handleScroll(event)}>\n          <div className=\"tag_info\">\n            <div className=\"tag_image\">\n              {tag.posts.length ? (\n                <img className=\"img\" src={tag.posts[0].images[0].url} />\n              ) : (\n                <img\n                  className=\"img\"\n                  src=\"https://kazcm.com/wp-content/uploads/2018/02/Hashtag.jpg\"\n                />\n              )}\n            </div>\n\n            <div className=\"tag_name\">\n              <h3>#{tag.tag.name}</h3>\n              <h6>{tag.posts.length} Bài viết</h6>\n            </div>\n            {tag.tag.followers.includes(this.props.user.userData._id) ? (\n              <div className=\"button_wrapper\">\n                <button\n                  type=\"button\"\n                  onClick={() =>\n                    this.unfollowTag(tag.tag._id, this.props.tags.tag)\n                  }\n                >\n                  Unfollow\n                </button>\n              </div>\n            ) : (\n              <div className=\"button_wrapper\">\n                <button\n                  type=\"button\"\n                  onClick={() =>\n                    this.followTag(tag.tag._id, this.props.tags.tag)\n                  }\n                >\n                  Follow\n                </button>\n              </div>\n            )}\n          </div>\n          <div className=\"posts\">\n            <div className=\"row\">\n              {tag.posts.map((item) => {\n                return item.hidden ? null : (\n                  <div className=\"col-xl-4 col-md-4  pb-3 pt-3 \">\n                    <div\n                      className=\"image-wrapper\"\n                      onClick={() => {\n                        this.props.history.push(`/postDetail/${item._id}`);\n                      }}\n                      style={{ backgroundImage: `url(${item.images[0].url})` }}\n                    ></div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n          {this.state.isLoading ? (\n            <div\n              className=\"main_loader\"\n              style={{\n                position: \"absolute\",\n                top: \"50%\",\n                left: \"50%\",\n                transform: \"translateX(-50 %) translateY(- 50 %)\",\n              }}\n            >\n              <CircularProgress style={{ color: \"#5477D5\" }} thickness={7} />\n            </div>\n          ) : (\n            \"\"\n          )}\n        </div>\n      </Layout>\n    ) : (\n      \"\"\n    );\n  }\n}\nfunction mapStateToProps(state) {\n  return {\n    user: state.user,\n    tags: state.tags,\n  };\n}\nexport default connect(mapStateToProps)(withRouter(Tag));\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"D:\\\\Kltn\\\\test\\\\social-media\\\\client\\\\src\\\\components\\\\Tag\\\\index.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport './Tag.scss';\nimport Layout from '../../hoc/layout';\nimport { getTag, followTag, unfollowTag } from '../../actions/tag_actions';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { Link, withRouter } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Tag extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      id: \"\",\n      skip: 0,\n      limit: 6,\n      isLoading: false\n    };\n\n    this.LoadmoreCards = () => {\n      let skip = this.state.skip + this.state.limit;\n      this.props.dispatch(getTag(this.state.id, this.state.skip, this.state.limit)).then(() => {\n        this.setState({\n          isLoading: false,\n          skip\n        });\n      });\n    };\n  }\n\n  componentDidMount() {\n    const id = this.props.match.params.id;\n    this.setState({\n      id: id\n    });\n    this.props.dispatch(getTag(id, this.state.skip, this.state.limit, []));\n  }\n\n  followTag(id, previousState) {\n    this.props.dispatch(followTag(id, previousState));\n  }\n\n  unfollowTag(id, previousState) {\n    this.props.dispatch(unfollowTag(id, previousState));\n  }\n\n  handleScroll() {\n    const windowHeight = \"innerHeight\" in window ? window.innerHeight : document.documentElement.offsetHeight;\n    const body = document.body;\n    const html = document.documentElement;\n    const docHeight = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);\n    const windowBottom = Math.ceil(windowHeight + window.pageYOffset);\n    console.log(windowBottom, docHeight, windowHeight);\n\n    if (windowBottom >= docHeight) {\n      this.setState({\n        isLoading: true\n      }, () => {\n        this.LoadmoreCards();\n      });\n      console.log('bottom reached');\n    }\n  }\n\n  render() {\n    const tag = this.props.tags.tag;\n    return this.props.tags.tag ? /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"TagPage\",\n        onScroll: event => this.handleScroll(event),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tag_info\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"tag_image\",\n            children: tag.posts.length ? /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"img\",\n              src: tag.posts[0].images[0].url\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 29\n            }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"img\",\n              src: \"https://kazcm.com/wp-content/uploads/2018/02/Hashtag.jpg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"tag_name\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: [\"#\", tag.tag.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n              children: [tag.posts.length, \" B\\xE0i vi\\u1EBFt\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 25\n          }, this), tag.tag.followers.includes(this.props.user.userData._id) ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"button_wrapper\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => this.unfollowTag(tag.tag._id, this.props.tags.tag),\n              children: \"Unfollow\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"button_wrapper\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => this.followTag(tag.tag._id, this.props.tags.tag),\n              children: \"Follow\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 32\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"posts\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: tag.posts.map(item => {\n              return item.hidden ? null : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-xl-4 col-md-4  pb-3 pt-3 \",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"image-wrapper\",\n                  onClick: () => {\n                    this.props.history.push(`/postDetail/${item._id}`);\n                  },\n                  style: {\n                    backgroundImage: `url(${item.images[0].url})`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 101,\n                  columnNumber: 33\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 100,\n                columnNumber: 33\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 17\n        }, this), this.state.isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"main_loader\",\n          style: {\n            position: 'absolute',\n            top: '50%',\n            left: '50%',\n            transform: 'translateX(-50 %) translateY(- 50 %)'\n          },\n          children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n            style: {\n              color: '#5477D5'\n            },\n            thickness: 7\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this) : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }, this) : \"\";\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    user: state.user,\n    tags: state.tags\n  };\n}\n\nexport default connect(mapStateToProps)(withRouter(Tag));","map":{"version":3,"names":["React","Component","connect","Layout","getTag","followTag","unfollowTag","CircularProgress","Link","withRouter","Tag","state","id","skip","limit","isLoading","LoadmoreCards","props","dispatch","then","setState","componentDidMount","match","params","previousState","handleScroll","windowHeight","window","innerHeight","document","documentElement","offsetHeight","body","html","docHeight","Math","max","scrollHeight","clientHeight","windowBottom","ceil","pageYOffset","console","log","render","tag","tags","event","posts","length","images","url","name","followers","includes","user","userData","_id","map","item","hidden","history","push","backgroundImage","position","top","left","transform","color","mapStateToProps"],"sources":["D:/Kltn/test/social-media/client/src/components/Tag/index.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport './Tag.scss'\r\nimport Layout from '../../hoc/layout';\r\nimport { getTag, followTag, unfollowTag} from '../../actions/tag_actions';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { Link, withRouter } from 'react-router-dom';\r\n\r\nclass Tag extends Component {\r\n\r\n    state = {\r\n        id: \"\",\r\n        skip: 0, \r\n        limit: 6,\r\n        isLoading: false,\r\n    }\r\n\r\n    componentDidMount() {\r\n        const id = this.props.match.params.id;\r\n        this.setState({\r\n            id: id\r\n        })\r\n        this.props.dispatch(getTag(id,this.state.skip, this.state.limit, []))\r\n    }\r\n\r\n    followTag(id,previousState) {\r\n        this.props.dispatch(followTag(id, previousState));\r\n    }\r\n\r\n    unfollowTag(id, previousState) {\r\n        this.props.dispatch(unfollowTag(id, previousState));\r\n    }\r\n\r\n    LoadmoreCards = () => {\r\n        let skip = this.state.skip + this.state.limit;\r\n        this.props.dispatch(getTag(\r\n            this.state.id,\r\n            this.state.skip,\r\n            this.state.limit\r\n        ))\r\n        .then(() => {\r\n            this.setState({\r\n                isLoading: false,\r\n                skip\r\n            })\r\n        })\r\n    }\r\n\r\n    handleScroll() {\r\n        const windowHeight = \"innerHeight\" in window ? window.innerHeight : document.documentElement.offsetHeight;\r\n        const body = document.body;\r\n        const html = document.documentElement;\r\n        const docHeight = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);\r\n        const windowBottom = Math.ceil(windowHeight + window.pageYOffset);\r\n        console.log(windowBottom, docHeight, windowHeight)\r\n        if (windowBottom >= docHeight) {\r\n            this.setState({ isLoading: true }, () => { this.LoadmoreCards()});\r\n            console.log('bottom reached');\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const tag = this.props.tags.tag;\r\n        return (\r\n            this.props.tags.tag?\r\n            <Layout>\r\n            <div className=\"TagPage\" onScroll={(event) => this.handleScroll(event)}>\r\n                <div className=\"tag_info\">\r\n                    <div className=\"tag_image\">\r\n                        {\r\n                            tag.posts.length ?\r\n                            <img className=\"img\" src={tag.posts[0].images[0].url} />\r\n                            :\r\n                            <img className=\"img\" src=\"https://kazcm.com/wp-content/uploads/2018/02/Hashtag.jpg\" /> \r\n                        }\r\n                    </div>\r\n                  \r\n                        <div className=\"tag_name\">\r\n                            <h3>#{tag.tag.name}</h3>\r\n                            <h6>{tag.posts.length} Bài viết</h6>\r\n                        </div>\r\n                        {\r\n                            tag.tag.followers.includes(this.props.user.userData._id)\r\n                            ?\r\n                            <div className=\"button_wrapper\">\r\n                                    <button type=\"button\" onClick={() => this.unfollowTag(tag.tag._id,this.props.tags.tag)}>Unfollow</button>\r\n                                </div>\r\n                            :  <div className=\"button_wrapper\"> \r\n                                    <button type=\"button\" onClick={() => this.followTag(tag.tag._id, this.props.tags.tag)}>Follow</button>\r\n                                </div>\r\n                        }\r\n                   \r\n                </div>\r\n                <div className=\"posts\">\r\n                    <div className=\"row\">\r\n                        {\r\n                        tag.posts.map((item)=>{\r\n                            return item.hidden ? null :\r\n                            (\r\n                                <div className=\"col-xl-4 col-md-4  pb-3 pt-3 \">\r\n                                <div className=\"image-wrapper\" onClick={()=>{\r\n                                        this.props.history.push(`/postDetail/${item._id}`)\r\n                                }} style={{backgroundImage: `url(${item.images[0].url})`}}>\r\n                                    \r\n                                </div>\r\n                            </div>)\r\n                        })\r\n                        }\r\n                    </div>\r\n                </div>\r\n                {\r\n                    this.state.isLoading ?\r\n                    <div className=\"main_loader\" style={{\r\n                        position: 'absolute',\r\n                        top: '50%',\r\n                        left: '50%',\r\n                        transform: 'translateX(-50 %) translateY(- 50 %)'\r\n                    }}>\r\n                        <CircularProgress style={{ color: '#5477D5' }} thickness={7} />\r\n                    </div>\r\n                    :\"\"\r\n                }\r\n            </div>\r\n            </Layout>\r\n            : \"\"\r\n        );\r\n    }\r\n}\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        user: state.user,\r\n        tags: state.tags,\r\n    };\r\n}\r\nexport default connect(mapStateToProps)(withRouter(Tag));"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAO,YAAP;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,SAASC,MAAT,EAAiBC,SAAjB,EAA4BC,WAA5B,QAA8C,2BAA9C;AACA,OAAOC,gBAAP,MAA6B,oCAA7B;AACA,SAASC,IAAT,EAAeC,UAAf,QAAiC,kBAAjC;;;AAEA,MAAMC,GAAN,SAAkBT,SAAlB,CAA4B;EAAA;IAAA;IAAA,KAExBU,KAFwB,GAEhB;MACJC,EAAE,EAAE,EADA;MAEJC,IAAI,EAAE,CAFF;MAGJC,KAAK,EAAE,CAHH;MAIJC,SAAS,EAAE;IAJP,CAFgB;;IAAA,KAyBxBC,aAzBwB,GAyBR,MAAM;MAClB,IAAIH,IAAI,GAAG,KAAKF,KAAL,CAAWE,IAAX,GAAkB,KAAKF,KAAL,CAAWG,KAAxC;MACA,KAAKG,KAAL,CAAWC,QAAX,CAAoBd,MAAM,CACtB,KAAKO,KAAL,CAAWC,EADW,EAEtB,KAAKD,KAAL,CAAWE,IAFW,EAGtB,KAAKF,KAAL,CAAWG,KAHW,CAA1B,EAKCK,IALD,CAKM,MAAM;QACR,KAAKC,QAAL,CAAc;UACVL,SAAS,EAAE,KADD;UAEVF;QAFU,CAAd;MAIH,CAVD;IAWH,CAtCuB;EAAA;;EASxBQ,iBAAiB,GAAG;IAChB,MAAMT,EAAE,GAAG,KAAKK,KAAL,CAAWK,KAAX,CAAiBC,MAAjB,CAAwBX,EAAnC;IACA,KAAKQ,QAAL,CAAc;MACVR,EAAE,EAAEA;IADM,CAAd;IAGA,KAAKK,KAAL,CAAWC,QAAX,CAAoBd,MAAM,CAACQ,EAAD,EAAI,KAAKD,KAAL,CAAWE,IAAf,EAAqB,KAAKF,KAAL,CAAWG,KAAhC,EAAuC,EAAvC,CAA1B;EACH;;EAEDT,SAAS,CAACO,EAAD,EAAIY,aAAJ,EAAmB;IACxB,KAAKP,KAAL,CAAWC,QAAX,CAAoBb,SAAS,CAACO,EAAD,EAAKY,aAAL,CAA7B;EACH;;EAEDlB,WAAW,CAACM,EAAD,EAAKY,aAAL,EAAoB;IAC3B,KAAKP,KAAL,CAAWC,QAAX,CAAoBZ,WAAW,CAACM,EAAD,EAAKY,aAAL,CAA/B;EACH;;EAiBDC,YAAY,GAAG;IACX,MAAMC,YAAY,GAAG,iBAAiBC,MAAjB,GAA0BA,MAAM,CAACC,WAAjC,GAA+CC,QAAQ,CAACC,eAAT,CAAyBC,YAA7F;IACA,MAAMC,IAAI,GAAGH,QAAQ,CAACG,IAAtB;IACA,MAAMC,IAAI,GAAGJ,QAAQ,CAACC,eAAtB;IACA,MAAMI,SAAS,GAAGC,IAAI,CAACC,GAAL,CAASJ,IAAI,CAACK,YAAd,EAA4BL,IAAI,CAACD,YAAjC,EAA+CE,IAAI,CAACK,YAApD,EAAkEL,IAAI,CAACI,YAAvE,EAAqFJ,IAAI,CAACF,YAA1F,CAAlB;IACA,MAAMQ,YAAY,GAAGJ,IAAI,CAACK,IAAL,CAAUd,YAAY,GAAGC,MAAM,CAACc,WAAhC,CAArB;IACAC,OAAO,CAACC,GAAR,CAAYJ,YAAZ,EAA0BL,SAA1B,EAAqCR,YAArC;;IACA,IAAIa,YAAY,IAAIL,SAApB,EAA+B;MAC3B,KAAKd,QAAL,CAAc;QAAEL,SAAS,EAAE;MAAb,CAAd,EAAmC,MAAM;QAAE,KAAKC,aAAL;MAAqB,CAAhE;MACA0B,OAAO,CAACC,GAAR,CAAY,gBAAZ;IACH;EACJ;;EAEDC,MAAM,GAAG;IACL,MAAMC,GAAG,GAAG,KAAK5B,KAAL,CAAW6B,IAAX,CAAgBD,GAA5B;IACA,OACI,KAAK5B,KAAL,CAAW6B,IAAX,CAAgBD,GAAhB,gBACA,QAAC,MAAD;MAAA,uBACA;QAAK,SAAS,EAAC,SAAf;QAAyB,QAAQ,EAAGE,KAAD,IAAW,KAAKtB,YAAL,CAAkBsB,KAAlB,CAA9C;QAAA,wBACI;UAAK,SAAS,EAAC,UAAf;UAAA,wBACI;YAAK,SAAS,EAAC,WAAf;YAAA,UAEQF,GAAG,CAACG,KAAJ,CAAUC,MAAV,gBACA;cAAK,SAAS,EAAC,KAAf;cAAqB,GAAG,EAAEJ,GAAG,CAACG,KAAJ,CAAU,CAAV,EAAaE,MAAb,CAAoB,CAApB,EAAuBC;YAAjD;cAAA;cAAA;cAAA;YAAA,QADA,gBAGA;cAAK,SAAS,EAAC,KAAf;cAAqB,GAAG,EAAC;YAAzB;cAAA;cAAA;cAAA;YAAA;UALR;YAAA;YAAA;YAAA;UAAA,QADJ,eAUQ;YAAK,SAAS,EAAC,UAAf;YAAA,wBACI;cAAA,gBAAMN,GAAG,CAACA,GAAJ,CAAQO,IAAd;YAAA;cAAA;cAAA;cAAA;YAAA,QADJ,eAEI;cAAA,WAAKP,GAAG,CAACG,KAAJ,CAAUC,MAAf;YAAA;cAAA;cAAA;cAAA;YAAA,QAFJ;UAAA;YAAA;YAAA;YAAA;UAAA,QAVR,EAeYJ,GAAG,CAACA,GAAJ,CAAQQ,SAAR,CAAkBC,QAAlB,CAA2B,KAAKrC,KAAL,CAAWsC,IAAX,CAAgBC,QAAhB,CAAyBC,GAApD,iBAEA;YAAK,SAAS,EAAC,gBAAf;YAAA,uBACQ;cAAQ,IAAI,EAAC,QAAb;cAAsB,OAAO,EAAE,MAAM,KAAKnD,WAAL,CAAiBuC,GAAG,CAACA,GAAJ,CAAQY,GAAzB,EAA6B,KAAKxC,KAAL,CAAW6B,IAAX,CAAgBD,GAA7C,CAArC;cAAA;YAAA;cAAA;cAAA;cAAA;YAAA;UADR;YAAA;YAAA;YAAA;UAAA,QAFA,gBAKG;YAAK,SAAS,EAAC,gBAAf;YAAA,uBACK;cAAQ,IAAI,EAAC,QAAb;cAAsB,OAAO,EAAE,MAAM,KAAKxC,SAAL,CAAewC,GAAG,CAACA,GAAJ,CAAQY,GAAvB,EAA4B,KAAKxC,KAAL,CAAW6B,IAAX,CAAgBD,GAA5C,CAArC;cAAA;YAAA;cAAA;cAAA;cAAA;YAAA;UADL;YAAA;YAAA;YAAA;UAAA,QApBf;QAAA;UAAA;UAAA;UAAA;QAAA,QADJ,eA2BI;UAAK,SAAS,EAAC,OAAf;UAAA,uBACI;YAAK,SAAS,EAAC,KAAf;YAAA,UAEIA,GAAG,CAACG,KAAJ,CAAUU,GAAV,CAAeC,IAAD,IAAQ;cAClB,OAAOA,IAAI,CAACC,MAAL,GAAc,IAAd,gBAEH;gBAAK,SAAS,EAAC,+BAAf;gBAAA,uBACA;kBAAK,SAAS,EAAC,eAAf;kBAA+B,OAAO,EAAE,MAAI;oBACpC,KAAK3C,KAAL,CAAW4C,OAAX,CAAmBC,IAAnB,CAAyB,eAAcH,IAAI,CAACF,GAAI,EAAhD;kBACP,CAFD;kBAEG,KAAK,EAAE;oBAACM,eAAe,EAAG,OAAMJ,IAAI,CAACT,MAAL,CAAY,CAAZ,EAAeC,GAAI;kBAA5C;gBAFV;kBAAA;kBAAA;kBAAA;gBAAA;cADA;gBAAA;gBAAA;gBAAA;cAAA,QAFJ;YASH,CAVD;UAFJ;YAAA;YAAA;YAAA;UAAA;QADJ;UAAA;UAAA;UAAA;QAAA,QA3BJ,EA6CQ,KAAKxC,KAAL,CAAWI,SAAX,gBACA;UAAK,SAAS,EAAC,aAAf;UAA6B,KAAK,EAAE;YAChCiD,QAAQ,EAAE,UADsB;YAEhCC,GAAG,EAAE,KAF2B;YAGhCC,IAAI,EAAE,KAH0B;YAIhCC,SAAS,EAAE;UAJqB,CAApC;UAAA,uBAMI,QAAC,gBAAD;YAAkB,KAAK,EAAE;cAAEC,KAAK,EAAE;YAAT,CAAzB;YAA+C,SAAS,EAAE;UAA1D;YAAA;YAAA;YAAA;UAAA;QANJ;UAAA;UAAA;UAAA;QAAA,QADA,GASC,EAtDT;MAAA;QAAA;QAAA;QAAA;MAAA;IADA;MAAA;MAAA;MAAA;IAAA,QADA,GA4DE,EA7DN;EA+DH;;AAtHuB;;AAwH5B,SAASC,eAAT,CAAyB1D,KAAzB,EAAgC;EAC5B,OAAO;IACH4C,IAAI,EAAE5C,KAAK,CAAC4C,IADT;IAEHT,IAAI,EAAEnC,KAAK,CAACmC;EAFT,CAAP;AAIH;;AACD,eAAe5C,OAAO,CAACmE,eAAD,CAAP,CAAyB5D,UAAU,CAACC,GAAD,CAAnC,CAAf"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"D:\\\\Kltn\\\\test\\\\social-media\\\\client\\\\src\\\\components\\\\Story\\\\StoryPage.js\";\nimport React, { Component } from 'react';\nimport './StoryPage.scss';\nimport { connect } from 'react-redux';\nimport Stories from 'react-insta-stories';\nimport { getStory, viewStory, deleteStory } from '../../actions/product_actions';\nimport { replyStory } from '../../../src/actions/message_action';\nimport { withRouter } from 'react-router-dom';\nimport { Sticker, Send, PlayerPlay, PlayerPause, ArrowLeft, ArrowRight } from 'tabler-icons-react';\nimport { Eye, Trash } from 'tabler-icons-react';\nimport { Picker } from 'emoji-mart';\nimport Reaction from '../Reaction/index';\nimport Slide from '@material-ui/core/Slide';\nimport { Snackbar } from '@material-ui/core';\nimport MuiAlert from '@material-ui/lab/Alert';\nconst Transition = React.forwardRef(function Transition(props, ref) {\n  return /*#__PURE__*/React.createElement(Slide, Object.assign({\n    direction: \"up\",\n    ref: ref\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 12\n    }\n  }));\n});\n\nclass StoryPage extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      storyId: \"\",\n      currentDisplay: 0,\n      previousStoryId: \"\",\n      storyToShow: null,\n      nextStoryId: \"\",\n      currentIndex: 0,\n      startIndex: 0,\n      end: -1,\n      isStoryPlaying: true,\n      content: '',\n      mess: {\n        sentTo: '',\n        sentBy: '',\n        content: '',\n        type: 'replyStory',\n        attachment: ''\n      },\n      sendSucess: false,\n      message: \"\"\n    };\n    this.loadingStory = {\n      url: \"https://nguahanoi.vn/wp-content/themes/gv-coporation/images/default.jpg\",\n      header: \"\"\n    };\n\n    this.endPosition = list => {\n      return list.findIndex(item => {\n        return item.stories.findIndex(item => {\n          return !item.viewedBy.some(item => item._id == this.props.user.userData._id);\n        }) == -1;\n      });\n    };\n\n    this.startIndex = stories => {\n      //tÃ¬m story \n      // let index = stories.findIndex(item => {return !item.viewedBy.includes(this.props.user.userData._id)});\n      let index = stories.findIndex(item => {\n        return !item.viewedBy.some(item => item._id == this.props.user.userData._id);\n      });\n\n      if (index === -1) {\n        return 0;\n      } else {\n        return index;\n      }\n    };\n\n    this.handleChange = event => {\n      this.setState({\n        mess: { ...this.state.mess,\n          content: event.target.value\n        }\n      });\n    };\n\n    this.nextStory = () => {\n      try {\n        if (this.state.nextStoryId != -1) {\n          const storyToShow = this.props.products.storyList.find(element => element._id === this.state.nextStoryId);\n          const index = this.props.products.storyList.indexOf(storyToShow);\n\n          if (index == this.state.end) {\n            this.props.history.push(`/newfeed`);\n          } else {\n            let startIndex = this.startIndex(storyToShow.stories);\n            let nextStoryId = -1;\n\n            if (index < this.props.products.storyList.length - 1) {\n              nextStoryId = this.props.products.storyList[index + 1]._id;\n            }\n\n            let previousStoryId = -1;\n\n            if (index > 0) {\n              previousStoryId = this.props.products.storyList[index - 1]._id;\n            }\n\n            console.log(storyToShow, nextStoryId, index, previousStoryId);\n            this.setState({\n              storyToShow: storyToShow,\n              nextStoryId: nextStoryId,\n              currentDisplay: index,\n              previousStoryId: previousStoryId,\n              startIndex: startIndex,\n              currentIndex: 0,\n              mess: { ...this.state.mess,\n                sentTo: storyToShow._id,\n                sentBy: this.props.user.userData._id,\n                attachment: storyToShow.stories[startIndex]._id\n              }\n            });\n          }\n        } else {\n          this.props.history.push(`/newfeed`);\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.previousStory = () => {\n      try {\n        if (this.state.previousStoryId != -1) {\n          const storyToShow = this.props.products.storyList.find(element => element._id === this.state.previousStoryId);\n          const index = this.props.products.storyList.indexOf(storyToShow); // if(index == this.state.end){\n          //     console.log(\"next story equals end index\")\n          //     // this.props.history.push(`/newfeed`);\n          // }else{\n\n          let startIndex = this.startIndex(storyToShow.stories);\n          let nextStoryId = -1;\n\n          if (index < this.props.products.storyList.length - 1) {\n            nextStoryId = this.props.products.storyList[index + 1]._id;\n          }\n\n          let previousStoryId = 0;\n\n          if (index > 0) {\n            previousStoryId = this.props.products.storyList[index - 1]._id;\n          }\n\n          console.log(storyToShow, nextStoryId, index, previousStoryId);\n          this.setState({\n            storyToShow: storyToShow,\n            nextStoryId: nextStoryId,\n            currentDisplay: index,\n            previousStoryId: previousStoryId,\n            startIndex: startIndex,\n            currentIndex: 0,\n            mess: { ...this.state.mess,\n              sentTo: storyToShow._id,\n              sentBy: this.props.user.userData._id,\n              attachment: storyToShow.stories[startIndex]._id\n            }\n          }); // }\n        } else {\n          console.log(\"next story equals -1\"); // this.props.history.push(`/newfeed`);\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.test = obj => {\n      console.log(\"testttttttttttttttttt\", obj.stories.map(item => {\n        return {\n          url: item.image,\n          header: {\n            profileImage: this.state.storyToShow.postedBy[0].avt,\n            heading: this.state.storyToShow.postedBy[0].userName,\n            subheading: \"12h\"\n          }\n        };\n      }));\n    };\n\n    this.close = () => {\n      console.log(\"close\");\n    };\n\n    this.customCollapsedComponent = ({\n      toggleMore,\n      action\n    }) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"story-overlay\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 16\n        }\n      }, this.state.isStoryPlaying ? /*#__PURE__*/React.createElement(PlayerPause, {\n        onClick: () => {\n          action('pause');\n          this.pauseStory();\n        },\n        size: 40,\n        strokeWidth: 2,\n        color: \"white\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 17\n        }\n      }) : /*#__PURE__*/React.createElement(PlayerPlay, {\n        onClick: () => {\n          action('play');\n          this.pauseStory();\n        },\n        size: 40,\n        strokeWidth: 2,\n        color: \"white\",\n        id: \"playStoryButton\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 17\n        }\n      }));\n    };\n\n    this.storyCreate = obj => {\n      return obj.stories.map(item => {\n        return {\n          url: item.image.url,\n          header: {\n            profileImage: this.state.storyToShow.postedBy[0].avt,\n            heading: this.state.storyToShow.postedBy[0].userName,\n            subheading: \"12h\"\n          },\n          seeMore: ({\n            close\n          }) => {\n            return /*#__PURE__*/React.createElement(\"div\", {\n              onClick: close,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 28\n              }\n            }, \"Hello, click to close this.\");\n          },\n          seeMoreCollapsed: this.customCollapsedComponent\n        };\n      });\n    };\n\n    this.viewStory = (items, index) => {\n      let nextId = '';\n\n      if (this.state.startIndex < this.state.storyToShow.stories.length) {\n        nextId = this.state.storyToShow.stories[this.state.startIndex]._id;\n      } else {\n        nextId = 0;\n      }\n\n      console.log(\"hereeeeee\", nextId);\n      this.setState({\n        mess: { ...this.state.mess,\n          attachment: nextId\n        }\n      }, () => {\n        console.log(\"hereeeeeeeeeeee\", this.state.mess);\n      });\n\n      if (index !== -1) {\n        viewStory(this.state.storyToShow.stories[index]._id);\n      }\n    };\n\n    this.increaseStartIndex = () => {\n      try {\n        if (this.state.startIndex < this.state.storyToShow.stories.length - 1) {\n          this.setState({\n            startIndex: this.state.startIndex + 1\n          });\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.deleteStory = () => {\n      this.props.dispatch(deleteStory(this.state.mess.attachment)).then(response => {\n        // console.log(\"delete storiesssss\",response)\n        if (response.payload.success) {\n          //Update story to show\n          //Update start index\n          //story will rerender\n          const storyToShow = { ...response.payload.storyList[0]\n          };\n\n          if (!response.payload.storyList.length || response.payload.storyList[0].stories.length == 0) {\n            this.props.history.push('/newfeed');\n          } else {\n            if (this.state.startIndex == response.payload.storyList[0].stories.length) {\n              this.pauseStory();\n              this.setState({\n                storyToShow: response.payload.storyList[0],\n                startIndex: this.state.startIndex - 1\n              });\n            } else {\n              this.pauseStory();\n              this.setState({\n                storyToShow: response.payload.storyList[0]\n              });\n            }\n          }\n        }\n      });\n    };\n\n    this.submitForm = event => {\n      event.preventDefault();\n      ;\n\n      if (this.state.mess.content.trim()) {\n        let dataToSubmit = this.state.mess;\n        console.log(dataToSubmit);\n        replyStory(dataToSubmit).then(response => {\n          if (response.messagelist) {\n            this.setState({\n              sendSucess: true,\n              message: \"success\",\n              mess: { ...this.state.mess,\n                content: ''\n              }\n            });\n          } else {\n            this.setState({\n              sendSucess: true,\n              message: \"error\"\n            });\n          }\n        });\n      } else {\n        console.log(\"Há» á»\");\n      }\n    };\n\n    this.sendReact = reaction => {\n      this.state.mess.content = reaction;\n      let dataToSubmit = this.state.mess;\n      dataToSubmit.type = \"replyWithReaction\";\n      replyStory(dataToSubmit).then(response => {\n        if (response.messagelist) {\n          this.setState({\n            sendSucess: true,\n            message: \"success\",\n            mess: { ...this.state.mess,\n              content: ''\n            }\n          });\n        } else {\n          this.setState({\n            sendSucess: true,\n            message: \"error\"\n          });\n        }\n      });\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.location.state == undefined) {\n      this.props.history.push(`/newfeed`);\n    } else {\n      const id = this.props.location.state.id;\n      this.setState({\n        storiId: id\n      });\n      this.props.dispatch(getStory(this.props.user.userData._id)).then(() => {\n        const storyToShow = this.props.products.storyList.find(element => element._id === id);\n        const index = this.props.products.storyList.indexOf(storyToShow); // tÃ¬m vá» trÃ­ stories cuá»i cÃ¹ng chÆ°a Äc xem bá»i ngÆ°á»i dÃ¹ng, khi xem háº¿t story nÃ y sáº½ direct qua trang NewFeed\n\n        let end = this.endPosition(this.props.products.storyList);\n        console.log(\"END INDEX\", end); // Vá» trÃ­ story báº¯t Äáº§u cá»§a storyToShow\n\n        let startIndex = this.startIndex(storyToShow.stories);\n        console.log(\"START INDEX\", startIndex); // Id cá»§a Stories tiáº¿p theo\n\n        let nextStoryId = -1;\n\n        if (index < this.props.products.storyList.length - 1) {\n          nextStoryId = this.props.products.storyList[index + 1]._id;\n        }\n\n        let previousStoryId = 0; // Id cá»§a story phÃ­a trÆ°á»c\n\n        if (index > 0) {\n          previousStoryId = this.props.products.storyList[index - 1]._id;\n        }\n\n        this.setState({\n          storyToShow: storyToShow,\n          currentDisplay: index,\n          nextStoryId: nextStoryId,\n          startIndex: startIndex,\n          previousStoryId: previousStoryId,\n          end: end,\n          mess: { ...this.state.mess,\n            sentTo: this.props.products.storyList[index]._id,\n            sentBy: this.props.user.userData._id,\n            attachment: this.props.products.storyList[index].stories[this.state.startIndex]._id\n          }\n        }); // console.log(this.state.currentDisplay, this.state.storyToShow, this.state.nextStoryId);\n      });\n    }\n  } // tÃ¬m vá» trÃ­ stories cuá»i cÃ¹ng chÆ°a Äc xem bá»i ngÆ°á»i dÃ¹ng, khi xem háº¿t story nÃ y sáº½ direct qua trang NewFeed\n\n\n  // playStory(){\n  //     const overlay = document.getElementById(\"playStoryButton\");\n  //     console.log(overlay)\n  // }\n  pauseStory() {\n    const reply = document.querySelector(\".reply-wrapper\"); // const overlay = document.querySelector(\".overlay\");\n\n    if (reply.classList.contains(\"displayed\")) {\n      reply.classList.remove(\"displayed\"); // overlay.classList.remove(\"overlay-displayed\")\n\n      this.setState({\n        isStoryPlaying: true\n      });\n    } else {\n      reply.classList.add(\"displayed\"); // overlay.classList.add(\"overlay-displayed\")\n\n      this.setState({\n        isStoryPlaying: false\n      });\n    }\n  }\n\n  render() {\n    return this.state.storyToShow ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"storyPage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"storyPage__header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"header__logo\",\n      onClick: () => {\n        this.props.history.push('/newfeed');\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      class: \"Logo_stunn\",\n      src: require('../../asset/logo/logoIcon2x.png'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      class: \"Logo_text\",\n      src: require('../../asset/logo/whiteLogo2x.png'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"close_button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      class: \"fas fa-times\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"current_story\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"story_wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 21\n      }\n    }, this.state.isStoryPlaying ? /*#__PURE__*/React.createElement(ArrowLeft, {\n      onClick: () => {\n        if (this.state.startIndex != 0) {\n          this.setState({\n            startIndex: this.state.startIndex - 1\n          }, () => {\n            this.viewStory(this.state.storyToShow, this.state.startIndex);\n          });\n        } else {\n          this.previousStory();\n        }\n      },\n      size: 40,\n      strokeWidth: 2,\n      color: \"white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 29\n      }\n    }) : \"\", /*#__PURE__*/React.createElement(Stories, {\n      stories: this.storyCreate(this.state.storyToShow),\n      defaultInterval: 5000,\n      width: \"26rem\",\n      height: \"100%\",\n      isPaused: true,\n      currentIndex: this.state.startIndex,\n      onStoryStart: () => {\n        this.viewStory(this.state.storyToShow, this.state.startIndex);\n      },\n      onStoryEnd: () => {\n        this.increaseStartIndex();\n      },\n      onAllStoriesEnd: () => this.nextStory(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 29\n      }\n    }), this.state.isStoryPlaying ? /*#__PURE__*/React.createElement(ArrowRight, {\n      onClick: () => {\n        console.log(this.state.startIndex, this.state.storyToShow.stories.length);\n\n        if (this.state.startIndex != this.state.storyToShow.stories.length - 1) {\n          this.setState({\n            startIndex: this.state.startIndex + 1\n          }, () => {\n            this.viewStory(this.state.storyToShow, this.state.startIndex);\n          });\n        } else {\n          this.nextStory();\n        }\n      },\n      size: 40,\n      strokeWidth: 2,\n      color: \"white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 29\n      }\n    }) : \"\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: this.state.mess.sentBy == this.state.mess.sentTo ? \"reply-wrapper space\" : \"reply-wrapper end\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: this.state.mess.sentBy == this.state.mess.sentTo ? \"main display\" : \"hiden\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"user-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"users-view-story\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Eye, {\n      size: 30,\n      strokeWidth: 2,\n      color: \"black\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 33\n      }\n    }), this.state.storyToShow.stories[this.state.startIndex].viewedBy.length != 0 ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 37\n      }\n    }, this.state.storyToShow.stories[this.state.startIndex].viewedBy.length, \" ng\\u01B0\\u1EDDi \\u0111\\xE3 xem \") : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 34\n      }\n    }, \"Ch\\u01B0a c\\xF3 ng\\u01B0\\u1EDDi xem\")), /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 29\n      }\n    }, this.state.storyToShow.stories[this.state.startIndex].viewedBy.map((item, idx) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item\",\n        key: idx,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 48\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        onClick: () => {// this.LinkTo(\"user\",item._id)\n        },\n        className: \"user_infor_wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 45\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: item.avt,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 49\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 49\n        }\n      }, item.userName)));\n    }))), /*#__PURE__*/React.createElement(Trash, {\n      onClick: this.deleteStory,\n      size: 25,\n      strokeWidth: 2,\n      color: \"black\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: this.state.mess.sentBy == this.state.mess.sentTo ? \"hiden\" : \"display\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Reaction, {\n      sendReact: reaction => this.sendReact(reaction),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: event => this.submitForm(event),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat_box\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat_area\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      id: \"description_textarea\",\n      autoComplete: \"none\",\n      type: \"text\",\n      value: this.state.mess.content,\n      placeholder: \"Nh\\u1EADp tin nh\\u1EAFn....\",\n      onChange: event => {\n        this.handleChange(event);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 37\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"emoji_icon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(Sticker, {\n      onClick: this.emojiClick,\n      size: 32,\n      strokeWidth: 1,\n      color: \"black\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 472,\n        columnNumber: 37\n      }\n    }), this.state.emojiToggle ? /*#__PURE__*/React.createElement(Picker, {\n      style: {\n        position: \"absolute\",\n        right: 0,\n        top: \"20%\"\n      },\n      onSelect: this.addEmoji,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 45\n      }\n    }) : null), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"sent_btn\",\n      className: \"send_icon\",\n      onClick: event => {\n        this.submitForm(event);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(Send, {\n      size: 32,\n      strokeWidth: 1,\n      color: \"white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 37\n      }\n    })))))), /*#__PURE__*/React.createElement(Snackbar, {\n      anchorOrigin: {\n        vertical: 'bottom',\n        horizontal: 'left'\n      },\n      open: this.state.sendSucess,\n      onClose: () => this.setState({\n        sendSucess: false\n      }),\n      autoHideDuration: 1000,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(MuiAlert, {\n      elevation: 6,\n      variant: \"filled\",\n      severity: this.state.message,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 21\n      }\n    }, this.state.message == \"success\" ? \"ÄÃ£ gá»­i tin nháº¯n\" : \"Xin thá»­ láº¡i\"))) : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507,\n        columnNumber: 15\n      }\n    }, \"loading\");\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user,\n    products: state.products\n  };\n};\n\nexport default connect(mapStateToProps)(withRouter(StoryPage));","map":{"version":3,"sources":["D:/Kltn/test/social-media/client/src/components/Story/StoryPage.js"],"names":["React","Component","connect","Stories","getStory","viewStory","deleteStory","replyStory","withRouter","Sticker","Send","PlayerPlay","PlayerPause","ArrowLeft","ArrowRight","Eye","Trash","Picker","Reaction","Slide","Snackbar","MuiAlert","Transition","forwardRef","props","ref","StoryPage","state","storyId","currentDisplay","previousStoryId","storyToShow","nextStoryId","currentIndex","startIndex","end","isStoryPlaying","content","mess","sentTo","sentBy","type","attachment","sendSucess","message","loadingStory","url","header","endPosition","list","findIndex","item","stories","viewedBy","some","_id","user","userData","index","handleChange","event","setState","target","value","nextStory","products","storyList","find","element","indexOf","history","push","length","console","log","err","previousStory","test","obj","map","image","profileImage","postedBy","avt","heading","userName","subheading","close","customCollapsedComponent","toggleMore","action","pauseStory","storyCreate","seeMore","seeMoreCollapsed","items","nextId","increaseStartIndex","dispatch","then","response","payload","success","submitForm","preventDefault","trim","dataToSubmit","messagelist","sendReact","reaction","componentDidMount","location","undefined","id","storiId","reply","document","querySelector","classList","contains","remove","add","render","require","idx","emojiClick","emojiToggle","position","right","top","addEmoji","vertical","horizontal","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component}  from 'react';\r\nimport './StoryPage.scss';\r\nimport { connect } from 'react-redux';\r\nimport Stories from 'react-insta-stories';\r\nimport { getStory, viewStory, deleteStory} from '../../actions/product_actions';\r\nimport { replyStory } from '../../../src/actions/message_action'\r\nimport { withRouter } from 'react-router-dom';\r\nimport { Sticker, Send, PlayerPlay, PlayerPause, ArrowLeft,  ArrowRight } from 'tabler-icons-react'\r\nimport { Eye,Trash } from 'tabler-icons-react';\r\nimport { Picker } from 'emoji-mart'\r\nimport Reaction from '../Reaction/index';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport { Snackbar } from '@material-ui/core';\r\nimport MuiAlert from '@material-ui/lab/Alert'\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n    return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nclass StoryPage extends Component {\r\n\r\n    state={\r\n        storyId: \"\",\r\n        currentDisplay: 0,\r\n        previousStoryId: \"\", \r\n        storyToShow: null,\r\n        nextStoryId: \"\",\r\n        currentIndex: 0,\r\n        startIndex: 0,\r\n        end: -1,\r\n        isStoryPlaying: true,\r\n        content: '',\r\n        mess: {\r\n            sentTo: '',\r\n            sentBy: '',\r\n            content: '',\r\n            type: 'replyStory',\r\n            attachment:'',\r\n        },\r\n        sendSucess: false,\r\n        message: \"\",\r\n    }\r\n    loadingStory = {\r\n        url: \"https://nguahanoi.vn/wp-content/themes/gv-coporation/images/default.jpg\",\r\n        header: \"\"\r\n    }\r\n    componentDidMount(){\r\n        if(this.props.location.state == undefined){\r\n            this.props.history.push(`/newfeed`)\r\n        }else{\r\n            const id = this.props.location.state.id;\r\n            this.setState({storiId:id});   \r\n            this.props.dispatch(getStory(this.props.user.userData._id)).then(()=>{\r\n                const storyToShow = this.props.products.storyList.find(element => element._id === id);\r\n                const index = this.props.products.storyList.indexOf(storyToShow);\r\n                // tÃ¬m vá» trÃ­ stories cuá»i cÃ¹ng chÆ°a Äc xem bá»i ngÆ°á»i dÃ¹ng, khi xem háº¿t story nÃ y sáº½ direct qua trang NewFeed\r\n                let end = this.endPosition(this.props.products.storyList);\r\n                console.log(\"END INDEX\",end);\r\n                // Vá» trÃ­ story báº¯t Äáº§u cá»§a storyToShow\r\n                let startIndex = this.startIndex(storyToShow.stories)\r\n                console.log(\"START INDEX\",startIndex);\r\n                // Id cá»§a Stories tiáº¿p theo\r\n                let nextStoryId = -1;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \r\n                if (index < this.props.products.storyList.length - 1) {\r\n                    nextStoryId = this.props.products.storyList[index + 1]._id;\r\n                }\r\n                let previousStoryId = 0;\r\n                // Id cá»§a story phÃ­a trÆ°á»c\r\n                if (index > 0) {\r\n                    previousStoryId = this.props.products.storyList[index - 1]._id;\r\n                }\r\n                this.setState({ \r\n                    storyToShow: storyToShow,\r\n                    currentDisplay: index,\r\n                    nextStoryId: nextStoryId,\r\n                    startIndex: startIndex,\r\n                    previousStoryId: previousStoryId,\r\n                    end: end,\r\n                    mess: {\r\n                        ...this.state.mess,\r\n                        sentTo: this.props.products.storyList[index]._id,\r\n                        sentBy: this.props.user.userData._id,\r\n                        attachment: this.props.products.storyList[index].stories[this.state.startIndex]._id,\r\n                    }\r\n                });\r\n                // console.log(this.state.currentDisplay, this.state.storyToShow, this.state.nextStoryId);\r\n            })\r\n        }\r\n    }\r\n    // tÃ¬m vá» trÃ­ stories cuá»i cÃ¹ng chÆ°a Äc xem bá»i ngÆ°á»i dÃ¹ng, khi xem háº¿t story nÃ y sáº½ direct qua trang NewFeed\r\n    endPosition = (list) => {\r\n        return list.findIndex(item => {\r\n            return item.stories.findIndex(item => {\r\n                return !item.viewedBy.some(item => item._id == this.props.user.userData._id)}) == -1\r\n        })\r\n    }\r\n\r\n    startIndex = (stories) => { \r\n        //tÃ¬m story \r\n        // let index = stories.findIndex(item => {return !item.viewedBy.includes(this.props.user.userData._id)});\r\n\r\n        let index = stories.findIndex(item => {return !item.viewedBy.some(item => item._id == this.props.user.userData._id)});\r\n        if(index === -1){\r\n            return 0;\r\n        }else{\r\n            return index; \r\n        }\r\n    }\r\n\r\n    handleChange = (event) => {\r\n        this.setState({mess: {...this.state.mess,content: event.target.value}});\r\n    }\r\n\r\n    nextStory = () => {\r\n        try{\r\n        if(this.state.nextStoryId!=-1)\r\n        {\r\n            const storyToShow = this.props.products.storyList.find(element => element._id === this.state.nextStoryId);\r\n            const index = this.props.products.storyList.indexOf(storyToShow);\r\n            if(index == this.state.end){\r\n                this.props.history.push(`/newfeed`);\r\n            }else{\r\n                let startIndex = this.startIndex(storyToShow.stories)\r\n                let nextStoryId = -1;\r\n                if (index < this.props.products.storyList.length - 1) {\r\n                    nextStoryId = this.props.products.storyList[index + 1]._id;\r\n                }\r\n                let previousStoryId = -1;\r\n                if (index > 0) {\r\n                    previousStoryId = this.props.products.storyList[index - 1]._id;\r\n                }\r\n                console.log(storyToShow,nextStoryId,index,previousStoryId)\r\n                this.setState({\r\n                    storyToShow: storyToShow,\r\n                    nextStoryId: nextStoryId,\r\n                    currentDisplay: index,\r\n                    previousStoryId: previousStoryId,\r\n                    startIndex: startIndex,\r\n                    currentIndex: 0,\r\n                    mess: {\r\n                        ...this.state.mess,\r\n                        sentTo: storyToShow._id,\r\n                        sentBy: this.props.user.userData._id,\r\n                        attachment: storyToShow.stories[startIndex]._id,\r\n                    }\r\n                });\r\n            }\r\n        }else{\r\n            this.props.history.push(`/newfeed`);\r\n        }\r\n        }catch(err){\r\n            console.log(err)\r\n        }\r\n    }\r\n    previousStory = () => {\r\n        try{\r\n        if(this.state.previousStoryId!=-1)\r\n        {\r\n            const storyToShow = this.props.products.storyList.find(element => element._id === this.state.previousStoryId);\r\n            const index = this.props.products.storyList.indexOf(storyToShow);\r\n            // if(index == this.state.end){\r\n            //     console.log(\"next story equals end index\")\r\n            //     // this.props.history.push(`/newfeed`);\r\n            // }else{\r\n                let startIndex = this.startIndex(storyToShow.stories)\r\n                let nextStoryId = -1;\r\n                if (index < this.props.products.storyList.length - 1) {\r\n                    nextStoryId = this.props.products.storyList[index + 1]._id;\r\n                }\r\n                let previousStoryId = 0;\r\n                if (index > 0) {\r\n                    previousStoryId = this.props.products.storyList[index - 1]._id;\r\n                }\r\n                console.log(storyToShow,nextStoryId,index,previousStoryId)\r\n                this.setState({\r\n                    storyToShow: storyToShow,\r\n                    nextStoryId: nextStoryId,\r\n                    currentDisplay: index,\r\n                    previousStoryId: previousStoryId,\r\n                    startIndex: startIndex,\r\n                    currentIndex: 0,\r\n                    mess: {\r\n                        ...this.state.mess,\r\n                        sentTo: storyToShow._id,\r\n                        sentBy: this.props.user.userData._id,\r\n                        attachment: storyToShow.stories[startIndex]._id,\r\n                    }\r\n                });\r\n            // }\r\n        }else{\r\n            console.log(\"next story equals -1\")\r\n            // this.props.history.push(`/newfeed`);\r\n        }\r\n        }catch(err){\r\n            console.log(err)\r\n        }\r\n    }\r\n    test = (obj) =>{\r\n        console.log( \"testttttttttttttttttt\",\r\n            obj.stories.map((item)=>{\r\n                return {\r\n                    url: item.image,\r\n                    header: {\r\n                    profileImage: this.state.storyToShow.postedBy[0].avt,\r\n                    heading: this.state.storyToShow.postedBy[0].userName,\r\n                    subheading:  \"12h\"\r\n                    }\r\n                }\r\n            })\r\n        )\r\n    }\r\n    close = () => {\r\n        console.log(\"close\")\r\n    }\r\n\r\n    // playStory(){\r\n    //     const overlay = document.getElementById(\"playStoryButton\");\r\n    //     console.log(overlay)\r\n    // }\r\n\r\n    pauseStory(){\r\n        const reply = document.querySelector(\".reply-wrapper\");\r\n        // const overlay = document.querySelector(\".overlay\");\r\n        if (reply.classList.contains(\"displayed\")){\r\n            reply.classList.remove(\"displayed\")\r\n            // overlay.classList.remove(\"overlay-displayed\")\r\n            this.setState({isStoryPlaying: true})\r\n        }else{\r\n            reply.classList.add(\"displayed\");\r\n            // overlay.classList.add(\"overlay-displayed\")\r\n            this.setState({isStoryPlaying: false})\r\n        }\r\n    }\r\n    customCollapsedComponent = ({ toggleMore, action }) => {\r\n        return <div className=\"story-overlay\">\r\n            {\r\n                this.state.isStoryPlaying ?\r\n                <PlayerPause onClick={() => {\r\n                    action('pause');\r\n                    this.pauseStory();\r\n                }} size={40} strokeWidth={2} color=\"white\"/>\r\n                :\r\n                <PlayerPlay onClick={() => {\r\n                    action('play');\r\n                    this.pauseStory();\r\n                }} size={40} strokeWidth={2} color=\"white\" id=\"playStoryButton\"/>\r\n            }\r\n        </div>\r\n    }\r\n\r\n    storyCreate = (obj) => {\r\n        \r\n        return obj.stories.map((item)=>{\r\n            return {\r\n                url: item.image.url,\r\n                header: {\r\n                   profileImage: this.state.storyToShow.postedBy[0].avt,\r\n                   heading: this.state.storyToShow.postedBy[0].userName,\r\n                   subheading:  \"12h\"\r\n                },\r\n                seeMore: ({ close }) => {\r\n                    return <div onClick={close}>Hello, click to close this.</div>;\r\n                },\r\n                seeMoreCollapsed: this.customCollapsedComponent\r\n            }\r\n        })\r\n    }\r\n\r\n    viewStory = (items,index) =>{\r\n        let nextId = '';\r\n        if(this.state.startIndex < this.state.storyToShow.stories.length)\r\n        {\r\n            nextId = this.state.storyToShow.stories[this.state.startIndex]._id\r\n        }else{\r\n            nextId = 0;\r\n        }\r\n        console.log(\"hereeeeee\",nextId)\r\n        this.setState({\r\n            mess: {\r\n                ...this.state.mess,\r\n                attachment: nextId,\r\n            }\r\n        },()=>{console.log(\"hereeeeeeeeeeee\",this.state.mess)});\r\n        if(index !== -1){\r\n            viewStory(this.state.storyToShow.stories[index]._id)\r\n        }\r\n    }\r\n\r\n    increaseStartIndex = () =>{\r\n        try{\r\n            if(this.state.startIndex < this.state.storyToShow.stories.length-1){\r\n                this.setState({\r\n                    startIndex: this.state.startIndex+1,\r\n                });\r\n            }\r\n        }catch(err){\r\n            console.log(err)\r\n        }\r\n    }\r\n\r\n    deleteStory = () =>{\r\n        this.props.dispatch(deleteStory(this.state.mess.attachment)).then(response => {\r\n            // console.log(\"delete storiesssss\",response)\r\n            if(response.payload.success){\r\n                //Update story to show\r\n                //Update start index\r\n                //story will rerender\r\n                const storyToShow = {...response.payload.storyList[0]}\r\n                if(!response.payload.storyList.length || response.payload.storyList[0].stories.length == 0)\r\n                {\r\n                    this.props.history.push('/newfeed')\r\n                }else{\r\n                    if(this.state.startIndex == response.payload.storyList[0].stories.length){\r\n                        this.pauseStory();\r\n                        this.setState({ \r\n                            storyToShow: response.payload.storyList[0],\r\n                            startIndex: this.state.startIndex -1\r\n                        });\r\n                    }else{\r\n                        this.pauseStory();\r\n                        this.setState({ \r\n                            storyToShow: response.payload.storyList[0],\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    submitForm = (event) => {\r\n        event.preventDefault();;\r\n        if(this.state.mess.content.trim()){\r\n            let dataToSubmit = this.state.mess;\r\n            console.log(dataToSubmit);\r\n            replyStory(dataToSubmit).then(response=>{\r\n                if(response.messagelist){\r\n                    this.setState({\r\n                        sendSucess: true,\r\n                        message: \"success\",\r\n                        mess:{\r\n                            ...this.state.mess,\r\n                            content: '',\r\n                        }\r\n                    })\r\n                }else{\r\n                    this.setState({\r\n                        sendSucess: true, \r\n                        message: \"error\",  \r\n                    })\r\n                }\r\n            });\r\n        }else{\r\n            console.log(\"Há» á»\");\r\n        }   \r\n    }\r\n\r\n    sendReact = (reaction) => {\r\n        this.state.mess.content = reaction\r\n       \r\n        let dataToSubmit = this.state.mess;\r\n        dataToSubmit.type = \"replyWithReaction\"\r\n        replyStory(dataToSubmit).then(response=>{\r\n            if(response.messagelist){\r\n                this.setState({\r\n                    sendSucess: true,\r\n                    message: \"success\",\r\n                    mess:{\r\n                        ...this.state.mess,\r\n                        content: '',\r\n                    }\r\n                })\r\n            }else{\r\n                this.setState({\r\n                    sendSucess: true, \r\n                    message: \"error\",  \r\n                })\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            this.state.storyToShow ?\r\n            <div className=\"storyPage\">\r\n                <div className=\"storyPage__header\">\r\n                    <div className=\"header__logo\" onClick={()=>{this.props.history.push('/newfeed')}}>\r\n                        <img class=\"Logo_stunn\"src={require('../../asset/logo/logoIcon2x.png')} />\r\n                        <img class=\"Logo_text\" src={require('../../asset/logo/whiteLogo2x.png')} />\r\n                    </div>\r\n                    <div className=\"close_button\">\r\n                        <i class=\"fas fa-times\"></i>\r\n                    </div>\r\n                </div>\r\n                <div className=\"current_story\">\r\n                    <div className=\"story_wrapper\">\r\n                            {\r\n                            this.state.isStoryPlaying ?\r\n                            <ArrowLeft onClick={() => {\r\n                                if(this.state.startIndex != 0){ \r\n                                    this.setState({ \r\n                                        startIndex: this.state.startIndex-1\r\n                                    },()=>{this.viewStory(this.state.storyToShow, this.state.startIndex)}); \r\n                                }else{\r\n                                    this.previousStory();\r\n                                }\r\n                            }} size={40} strokeWidth={2} color=\"white\"/>\r\n                            : \"\"\r\n                            }\r\n                            <Stories\r\n                                stories={this.storyCreate(this.state.storyToShow)}\r\n                                defaultInterval={5000}\r\n                                width=\"26rem\"\r\n                                height=\"100%\"\r\n                                isPaused={true}\r\n                                currentIndex={this.state.startIndex}\r\n                                onStoryStart={() => {this.viewStory(this.state.storyToShow, this.state.startIndex)}}\r\n                                onStoryEnd={()=>{this.increaseStartIndex()}}\r\n                                onAllStoriesEnd={() => this.nextStory()}\r\n                            />\r\n                            {\r\n                            this.state.isStoryPlaying ?\r\n                            <ArrowRight onClick={() => {\r\n                                console.log(this.state.startIndex,this.state.storyToShow.stories.length)\r\n                                if(this.state.startIndex != this.state.storyToShow.stories.length-1){\r\n                                    this.setState({ \r\n                                        startIndex: this.state.startIndex+1\r\n                                    },()=>{this.viewStory(this.state.storyToShow, this.state.startIndex)});\r\n                                }else{\r\n                                    this.nextStory()\r\n                                }\r\n                            }} size={40} strokeWidth={2} color=\"white\"/>\r\n                            :\"\"}\r\n                    </div>\r\n                </div>\r\n                {/* <div className=\"overlay\" onClick={this.playStory}></div> */}\r\n                <div className={this.state.mess.sentBy == this.state.mess.sentTo ? \"reply-wrapper space\" : \"reply-wrapper end\"}>\r\n                    <div className={this.state.mess.sentBy == this.state.mess.sentTo ? \"main display\" : \"hiden\"}>\r\n                        <div className=\"user-list\">\r\n                            <div className=\"users-view-story\">\r\n                                <Eye size={30} strokeWidth={2} color=\"black\"/>\r\n                                {this.state.storyToShow.stories[this.state.startIndex].viewedBy.length != 0 ?\r\n                                    <p>{this.state.storyToShow.stories[this.state.startIndex].viewedBy.length} ngÆ°á»i ÄÃ£ xem </p>\r\n                                :<p>ChÆ°a cÃ³ ngÆ°á»i xem</p>   \r\n                                }\r\n                            </div>\r\n                            <ul>\r\n                                {\r\n                                    this.state.storyToShow.stories[this.state.startIndex].viewedBy.map((item,idx) =>{\r\n                                        return <div className=\"item\" key={idx}>\r\n                                            <div onClick={() => {\r\n                                                // this.LinkTo(\"user\",item._id)\r\n                                            }} className=\"user_infor_wrapper\">\r\n                                                <img src={item.avt} />\r\n                                                <p>{item.userName}</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    })\r\n                                }\r\n                            </ul>\r\n                        </div>\r\n                        <Trash onClick={this.deleteStory} size={25} strokeWidth={2} color=\"black\"/>\r\n                    </div>\r\n                    <div className={this.state.mess.sentBy == this.state.mess.sentTo ? \"hiden\" : \"display\"}>\r\n                            <Reaction\r\n                                sendReact = {(reaction) => this.sendReact(reaction)}\r\n                            />\r\n                            <form  onSubmit={(event) => this.submitForm(event)}>\r\n                            <div className=\"chat_box\">\r\n                                <div className=\"chat_area\">\r\n                                    <input id=\"description_textarea\" autoComplete=\"none\" type=\"text\" value={this.state.mess.content} placeholder=\"Nháº­p tin nháº¯n....\" onChange={(event) => { this.handleChange(event) }}></input>\r\n                                </div>\r\n                                <div className=\"emoji_icon\">\r\n                                    <Sticker onClick={this.emojiClick} size={32} strokeWidth={1} color=\"black\"></Sticker>\r\n                                    {\r\n                                        this.state.emojiToggle ?\r\n                                            <Picker style={{ position: \"absolute\", right: 0, top: \"20%\" }} onSelect={this.addEmoji} />\r\n                                        : null\r\n                                    }\r\n                                </div>\r\n                                <div  id=\"sent_btn\" className=\"send_icon\" onClick={(event) => { this.submitForm(event) }}>\r\n                                    <Send size={32} strokeWidth={1} color=\"white\"></Send>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n                \r\n                 {\r\n                <Snackbar\r\n                    anchorOrigin={{\r\n                        vertical: 'bottom',\r\n                        horizontal: 'left'\r\n                    }}\r\n                    open={this.state.sendSucess}\r\n                    onClose={() => this.setState({ sendSucess: false })}\r\n                    autoHideDuration={1000}\r\n                >\r\n                    <MuiAlert elevation={6} variant=\"filled\" severity={this.state.message} >\r\n                        {\r\n                            this.state.message == \"success\" ?\r\n                            \"ÄÃ£ gá»­i tin nháº¯n\"\r\n                            : \"Xin thá»­ láº¡i\"\r\n                        }\r\n                    </MuiAlert>\r\n                </Snackbar>\r\n                }\r\n            </div>\r\n            : <div>loading</div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        user: state.user,\r\n        products: state.products\r\n    }\r\n}\r\nexport default connect(mapStateToProps)(withRouter(StoryPage));"]},"metadata":{},"sourceType":"module"}